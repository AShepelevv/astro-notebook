%%% Русский шрифт
\RequirePackage[utf8]{inputenc}
\RequirePackage[russian]{babel}
\RequirePackage[OT1]{fontenc}

\RequirePackage{pscyr}

%%% Математика

% Шрифты для математики
\RequirePackage{amsmath}
\RequirePackage{amsfonts}
\RequirePackage{amssymb}
\RequirePackage{cancel}
\RequirePackage{mathrsfs}
\RequirePackage{mathtools}
\RequirePackage{upgreek}
\RequirePackage{xfrac}

% Математические команды
\renewcommand{\vec}[1]{\mathbf{#1}}
\newcommand{\R}{\mathbb{R}}
\renewcommand{\L}{\mathcal{L}}
\newcommand{\scalar}[2]{\left(\vec{#1} \cdot \vec{#2}\right)}
\newcommand{\scalarNoVec}[2]{\left(#1 \cdot #2 \right)}
\newcommand{\cross}[2]{\left[\vec{#1} \times \vec{#2}\right]}
\newcommand{\triple}[3]{\left( \vec{#1}, \vec{#2}, \vec{#3} \right)}
\DeclareMathOperator{\T}{T}
\DeclareMathOperator{\pr}{pr}
\DeclareMathOperator{\argmax}{argmax}
\newcommand{\LL}{\mathcal{L}}

% Операторы
\DeclareMathOperator{\const}{const}
\DeclareMathOperator{\area}{Area}

% Астрономические символы
\RequirePackage{wasysym}
\RequirePackage{starfont} % Значок Цереры

% Настройки для математики
\setcounter{MaxMatrixCols}{20}


%%% Поля и разметка страницы
%\RequirePackage[inner=1.5cm, outer=0.9cm, top=1.5cm, bottom=1.2 cm, headsep=4mm]{geometry} % Старая
\RequirePackage[inner=2.0cm, outer=1.5cm, top=2cm, bottom=1.5 cm, headsep=4mm]{geometry} % Новая


%%% Набор текста

% Разрывы страниц в формулах
\allowdisplaybreaks

% Последняя строка абзаца
\widowpenalty10000
\clubpenalty10000

%%% Иллюстрации
\RequirePackage{graphicx}
\RequirePackage{wrapfig}
\RequirePackage[export]{adjustbox}
\graphicspath{{./img/}}

% Графики
\RequirePackage{pgfplots}
\pgfplotsset{compat = 1.3}
\usepgfplotslibrary{patchplots}
%\RequirePackage{patchplots}
\pgfplotsset{	width	=	14	cm,
    x label style={
        font = {\small\sffamily},
        yshift = 1mm
    },
    tick label style={
        font = {\scriptsize},
    },
    y label style={
        font = {\small\sffamily},
        yshift = -1mm,
        at={(ticklabel cs:0.5)},
%      					rotate=90,
        anchor=near ticklabel
    },
    every tick/.style	=	{
        black,
        line width 	= 	.5	pt
    },
    axis line style 	= 	{
        line width 	= 	.5	pt
    },
    grid style	=	{
        gray,
        dotted
    },
    minor x tick num = 1,
    minor y tick num = 1,
    no markers,
    grid = major,
    every axis/.append style	=	{
        line width	=	.7	pt
    }
}

%Подписи
\RequirePackage		[margin		= 10	pt,
    font		= footnotesize,
    labelfont	= bf,
    labelsep	= endash,
    labelfont	= bf,
    textfont	= sl,
    margin		= 0 	pt,
    aboveskip 	= 4		pt,
    belowskip 	= -6	pt]	{caption}
\RequirePackage		[margin		= 10	pt,
    font		= footnotesize,
    labelfont	= bf,
    labelsep	= endash,
    labelfont	= bf,
    textfont	= sl,
    margin		= 0 	pt,
    aboveskip 	= 4		pt,
    belowskip 	= 6	pt]	{subcaption}

%%% Insert pdf pages
\RequirePackage[final]{pdfpages}


%%% Color highlight
\RequirePackage{xcolor}


%%% TiKZ
\RequirePackage{tikz}
\RequirePackage{tkz-euclide}
\RequirePackage{tikz-3dplot}
\RequirePackage{style/tikz-3dplot-circleofsphere}
\RequirePackage{style/plotting}

\usetikzlibrary{external}
\tikzexternalize[prefix=tikz/resource/,optimize command away=\includepdf]
\usetikzlibrary{
    angles,
    calc,
    calligraphy,
    decorations.markings,
    decorations.pathreplacing,
    fadings,
    shapes,
    snakes,
    quotes
}

\input{sys/tikz-commands}

\makeatletter

\tikzset{
    every picture/.style={line cap=round},
% dot diameter/.store in=\dot@diameter,
% dot diameter=3pt,
    dot spacing/.store in=\dot@spacing,
    dot spacing = 4pt,
    dashes/.style={
        %        line width=\dot@diameter,
        line cap=round,
        dash pattern=on 4pt off \dot@spacing
    },
    triple arc/.style={
        double distance=2pt,
        pic actions/.append code=\tikzset{postaction={draw}}
    },
    markII/.style={%
        decoration={% 
            post length=1mm,
            pre length=1mm,
            markings, %
            mark= at position 0.5 with {%
                \draw (-0.5pt,-1.5pt) -- (-0.5pt,1.5pt);
                \draw (0.5pt,-1.5pt) -- (0.5pt,1.5pt);
            }% 
        },%
        pic actions/.append code=\tikzset{postaction=decorate}%
    }%
}

\makeatother

%%% Таблицы
\RequirePackage{tabularx}
\newcolumntype{L}[1]{>{\hsize=#1\hsize\raggedright\arraybackslash}X}%
\newcolumntype{R}[1]{>{\hsize=#1\hsize\raggedleft\arraybackslash}X}%
\newcolumntype{C}[1]{>{\hsize=#1\hsize\centering\arraybackslash}X}


%%% Нумерованные списки
\RequirePackage{enumitem}
\setlist[enumerate]{itemsep=1pt, label={\arabic*.}, leftmargin=1pc}
\setlist[itemize]{itemsep=1pt, label={$\circ$}, leftmargin=1pc}


%%% Новые команды
\newcommand{\term}[2][]{\,\!{\sffamily\bfseries#2}%
\ifthenelse{\isempty{#1}}{}{\index{#1}}}
\newcommand{\moon}{\!\!\rightmoon}
\newcommand{\au}{\text{а.\,е.}}
\newcommand{\tw}{\textwidth}
\newcommand{\imp}[1]{{\itshape#1}}

\newcommand{\change}[1]{\textcolor{red}{#1}}

\newcommand*{\SectorRadius}{1ex}
\newcommand*{\SectorHalfAngle}{40}
\newcommand*{\SectorLineWidth}{.5pt}


\newcommand{\picRef}[1]{Рис.\;\ref{#1}}
\newcommand{\lookPicRef}[1]{см.~\picRef{#1}}

\newcommand*{\sector}{%
    \begin{pgfpicture}
        \pgfpathmoveto{\pgforigin}%
        \pgfpathlineto{\pgfpointpolar{90-(\SectorHalfAngle)}{\SectorRadius}}%
        \pgfarc{90-(\SectorHalfAngle)}{90+\SectorHalfAngle}{\SectorRadius}%
        \pgfpathclose
        \pgfsetlinewidth{\SectorLineWidth}%
        \pgfusepath{stroke}%
    \end{pgfpicture}%
}


%%% Cчетчики
\renewcommand{\theequation}{\thesection.\arabic{equation}}
\numberwithin{equation}{section}


%%% Размеры
\setlength {\parskip} { 4pt }
%\setlength {\parindent} { 0pt }
\renewcommand {\baselinestretch}{ 1.02 }


%%% Гиперссылки
\RequirePackage{hyperref}
\hypersetup	{
    colorlinks=false,
    linktoc=all
}


%%% Колонтитулы
\RequirePackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\fancyhead[CO]{\slshape \small \leftmark}
\fancyhead[LE, RO]{\slshape \small \thepage}
\fancyhead[CE]{\slshape \hyperref[toc]{Астрадь}}


\RequirePackage{url}

\RequirePackage{makeidx}
\makeindex

\RequirePackage{ifmtarg}
\RequirePackage{textcase}

\RequirePackage{ifthen}
\newboolean{useLightPlotVersion}

\tkzSetUpLine[line width=0.4pt]
\tkzSetUpArc[line width=0.4pt]
\tkzSetUpPoint[fill=white, size=2]
\tkzSetUpLabel[font=\footnotesize]
