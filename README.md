# Астрадь

В данном репозитории содержится исходный код будущего, уже третьего, издания Астради – сборника теории по астрономии. Стоит отметить, из определения Астради пропало слово "_краткий_". После печати второго издания було принято решение расширить круг тем и глубину их изложение и сделать третье, совершенно новое, издание.

### Почему исходный код стал открытым?

Я, Алексей Шепелев, основной автор Астради, к сожалению, пришел к неутешительному выводу: вряд ли смогу самостоятельно закончить начатое. На это есть несколько причин, основная – я все меньше занимаюсь астрономией и её преподаванием, вторичная – после окончания университета и появления основной работы не хватает времени для поддержания должного уровня знаний в астрономии.

Однако было бы грустно, если многие сотни часов работы над данным материалом будут закопаны, так и не принеся пользы. Поэтому было принято решение открыть репозиторий, чтобы любой желающий мог ознакомиться с **черновиками** и, быть может, узнать для себя что-то новое.

Здесь важно подчеркнуть, что это именно черновики третьего издания. Конечно, все разделы имеют разную готовности: некоторые готовы полностью, некоторые остались нетронуты со второго издания и требуют доработки, некоторые написаны не полностью, где-то нет логической связи с другими разделами и пр. Но я уверен, ко ищет, тот найдет. Позже здесь в [README](README.md) появится список всех разделов с комментариями о готовности каждого. И описание планов по доработкам книги.

Мы готовы к соавторству! Давайте доделаем этот проект вместе. Приносите свои Pull Requests в ветку master, технические подробности можно найти ниже. Позже появится доска, например, Trello, где можно будет ознакомиться в планами по доработкам Астради. Если вы уже сейчас хотите влиться в дружный коллектив авторов, пишите в Telegram [@ashepelevv](https://t.me/ashepelevv), в крайнем случае на почту [ashepelev@phystech.edu](mailto:shepelev.as@phystech.edu).

### Что нового?
Пожалуй, не буду пегружать эту страницу, а лишь скажу, что в книге появилось предисловие от авторов. Там можно подробно ознакомиться о концепции книги, а задумке и мыслях авторов. Кто готов читать исходных код в LaTeX, то предисловие находится [здесь](sys/preface.tex).

### Лицензия и ограничение на использование
Этот проект лицензирован в соответствии с _Лицензией на использование в образовательных целях_. Код может использоваться только в образовательных целях. Подробнее см. в файле [LICENSE](LICENSE.txt).

Ниже приведени инструкции как скачать уже собранных PDF файл, как собрать его самостоятельно и как можно поучаствовать в написании Астради.

## Как скачать PDF

### Самый простой способ

Периодически в папку [/export](export) будут добавляться новые версии полностью скомпилированной книжки. Чтобы скачать файл, перейдя открыв данную папку, нужно

1. Нажать на название нужной версии ![Нажмите на название нужной версии](readme/pdf/export/filename.png)
2. В правом верхнем углу нажать на кнопку "Скачать" ![Скачать в правом верхнем углу](readme/pdf/export/download.png)

### Получить актуальную версию
Своевременно появление версий в [/export](export) не гарантировано, так как происходит вручную. Однако в репозитории настроены автоматические действия при появлении нового коммита – собирается проект и результат доступен в виде PDF. Чтобы его скачать, нужно
1. Перейти во вкладку [Actions](https://github.com/AShepelevv/astro.notebook/actions). ![](readme/pdf/actions/actions-tab.png)
2. Если интересуют только "стабильные" версии, можно воспользоваться фильтром по ветке и указать там master. [Ссылка на фильтр](https://github.com/AShepelevv/astro.notebook/actions?query=branch%3Amaster) ![](readme/pdf/actions/stable-version.png)
3. Выбрать нужную сборку, например, ![](readme/pdf/actions/select-build.png)
4. Внизу страницы будет блок "Artifacts", единственный артифакт – это pdf. Справа кнопка, которой можно его скачать
![](readme/pdf/actions/artifact.png)

**_P.S._** К сожалению в публичных репозиториях артифакты хранятся не более 90 дней. Постараемся своевременно обновлять версии в `/export`, чтобы перекрывать этот промежуток

**_P.S.S._** При сборке на сервере используется флаг `useLightPlotVersion`, что означает что несколько (~4-5) иллюстраций не будут отрисованы. Однако эти иллюстрации давно пришли к своему финальному виду, и pdf в `/export` содержат их.

## Сборка

### Системные требования

* [Tex Live 2024](https://www.tug.org/texlive/acquire-netinstall.html), полная версия
* Увеличить доступную оперативную память для LaTeX:
  * Например, на Mac OS нужно в файл `~/Library/texmf/web2c/texmf.cnf` (создать, если его нет) записать следующее:

  ```
  main_memory = 10000000
  extra_mem_bot = 2000000
  extra_mem_top = 2000000
  param_size = 10000
  ```

### Запуск

```bash
sh build.sh
```

Прогресс первой сборки (очень долгой) можно смотреть по увеливению количества файлов в папке [tikz/resource](tikz/resource). Там будет храниться локальный кэш картинок, сгенерированных с помощью TikZ.

## Соавторство

Свои правки и идеи новых разделов приносите в виде Pull Request в ветку master, будем рады обсудить их и добавить в книжку.

Для разработки дополнительно к пунктам из раздела **Сборка** может понадобиться:

* [Python 3.*](https://www.python.org)
* [Jupyter Notebook](https://jupyter.org)
* [Wolfram Mathematica 14+](https://www.wolfram.com/mathematica/)
* [ipe](https://ipe.otfried.org) для правки старых иллюстрацих
