\documentclass[10pt, a5paper, twoside]{article}

%%% Дата
\newcommand{\publish}{3}
\newcommand{\signed}{22.12.2020}
\renewcommand{\year}{2023}
\newcommand{\isbn}{ISBN 978-5-9909877-2-2}

%%% Русский шрифт
\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}
\usepackage[OT1]{fontenc}

\usepackage{pscyr}

%%% Математика

% Шрифты для математики
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{cancel}
\usepackage{mathrsfs}
\usepackage{mathtools}
\usepackage{upgreek}
\usepackage{xfrac}

% Математические команды
\renewcommand{\vec}[1]{\mathbf{#1}}
\newcommand{\R}{\mathbb{R}}
\renewcommand{\L}{\mathcal{L}}
\newcommand{\scalar}[2]{\left(\vec{#1} \cdot \vec{#2}\right)}
\newcommand{\scalarNoVec}[2]{\left(#1 \cdot #2 \right)}
\newcommand{\cross}[2]{\left[\vec{#1} \times \vec{#2}\right]}
\newcommand{\triple}[3]{\left( \vec{#1}, \vec{#2}, \vec{#3} \right)}
\DeclareMathOperator{\T}{T}
\DeclareMathOperator{\pr}{pr}
\DeclareMathOperator{\argmax}{argmax}
\newcommand{\LL}{\mathcal{L}}

% Операторы
\DeclareMathOperator{\const}{const}
\DeclareMathOperator{\area}{Area}

% Астрономические символы
\usepackage{wasysym}
\usepackage{starfont} % Значок Цереры

% Настройки для математики
\setcounter{MaxMatrixCols}{20}


%%% Поля и разметка страницы
%\usepackage[inner=1.5cm, outer=0.9cm, top=1.5cm, bottom=1.2 cm, headsep=4mm]{geometry} % Старая
\usepackage[inner=2.0cm, outer=1.5cm, top=2cm, bottom=1.5 cm, headsep=4mm]{geometry} % Новая


%%% Набор текста

% Разрывы страниц в формулах
\allowdisplaybreaks

% Последняя строка абзаца
\widowpenalty10000
\clubpenalty10000

%%% Иллюстрации
\usepackage{graphicx}
\usepackage{wrapfig}
\usepackage[export]{adjustbox}
\graphicspath{{./img/}}

% Графики
\usepackage{pgfplots}
\pgfplotsset{compat = 1.3}
\usepgfplotslibrary{patchplots}
%\usepackage{patchplots}
\pgfplotsset{	width	=	14	cm,
					x label style={
        					font = {\small\sffamily},
        					yshift = 1mm
      				},
      				tick label style={
      					font = {\scriptsize},
      				},
      				y label style={
      					font = {\small\sffamily},
      					yshift = -1mm,
      					at={(ticklabel cs:0.5)},
%      					rotate=90,
      					anchor=near ticklabel
      				},
      				every tick/.style	=	{
						black, 
						line width 	= 	.5	pt
					},
					axis line style 	= 	{
						line width 	= 	.5	pt
					},
					grid style	=	{
						gray,
						dotted
					},
					minor x tick num = 1,
 					minor y tick num = 1,
 					no markers,
 					grid = major,
 					every axis/.append style	=	{
 						line width	=	.7	pt
 					}
				}
				
%Подписи
\usepackage		[margin		= 10	pt,
					font		= footnotesize, 
					labelfont	= bf, 
					labelsep	= endash, 
					labelfont	= bf,
					textfont	= sl,
					margin		= 0 	pt,  
					aboveskip 	= 4		pt, 
					belowskip 	= -6	pt]	{caption}
\usepackage		[margin		= 10	pt,
					font		= footnotesize, 
					labelfont	= bf, 
					labelsep	= endash, 
					labelfont	= bf,
					textfont	= sl,
					margin		= 0 	pt,  
					aboveskip 	= 4		pt, 
					belowskip 	= 6	pt]	{subcaption}

%%% Insert pdf pages
\usepackage[final]{pdfpages}


%%% Color highlight
\usepackage{xcolor}


%%% TiKZ
\usepackage{tikz}
\usepackage{tkz-euclide}

\usetikzlibrary{external}
\tikzexternalize[prefix=tikz/resource/,optimize command away=\includepdf]
\usetikzlibrary{calc, fadings, decorations.markings, shapes, snakes}

\tkzSetUpLine[line width=0.4pt]
\tkzSetUpPoint[fill=white, size=2]
\tkzSetUpLabel[font=\scriptsize]


\input{sys/tikz-commands}

% todo: Убрать, когда перепишутся рисунки, от него зависимые
\usetikzlibrary{ipe}
\tikzstyle{ipe stylesheet} = [
  ipe import,
  even odd rule,
  line join=round,
  line cap=round,
  ipe pen normal/.style={line width=0.4},
  ipe pen heavier/.style={line width=0.8},
  ipe pen fat/.style={line width=1.2},
  ipe pen ultrafat/.style={line width=2},
  ipe pen normal,
  ipe mark normal/.style={ipe mark scale=3},
  ipe mark large/.style={ipe mark scale=5},
  ipe mark small/.style={ipe mark scale=2},
  ipe mark tiny/.style={ipe mark scale=1.1},
  ipe mark normal,
  /pgf/arrow keys/.cd,
  ipe arrow normal/.style={scale=7},
  ipe arrow large/.style={scale=10},
  ipe arrow small/.style={scale=5},
  ipe arrow tiny/.style={scale=3},
  ipe arrow normal,
  /tikz/.cd,
  ipe arrows, % update arrows
  <->/.tip = ipe normal,
  ipe dash normal/.style={dash pattern=},
  ipe dash dashed/.style={dash pattern=on 4pt off 4pt},
  ipe dash dotted/.style={dash pattern=on 5pt off 2pt on .5pt off 2pt},
  ipe dash dash dotted/.style={dash pattern=on 4bp off 2bp on 1bp off 2bp},
  ipe dash dash dot dotted/.style={dash pattern=on 4bp off 2bp on 1bp off 2bp on 1bp off 2bp},
  ipe dash normal,
  ipe node/.append style={font=\normalsize},
  ipe stretch normal/.style={ipe node stretch=1},
  ipe stretch normal,
  ipe opacity 10/.style={opacity=0.1},
  ipe opacity 30/.style={opacity=0.3},
  ipe opacity 50/.style={opacity=0.5},
  ipe opacity 75/.style={opacity=0.75},
  ipe opacity opaque/.style={opacity=1},
  ipe opacity opaque,
]
%\usetikzlibrary{decorations.text}

\tikzset{every picture/.style={line cap=round}}

\makeatletter

\tikzset{
% dot diameter/.store in=\dot@diameter,
% dot diameter=3pt,
    dot spacing/.store in=\dot@spacing,
    dot spacing = 4pt,
    dashes/.style={
%        line width=\dot@diameter,
        line cap=round,
        dash pattern=on 4pt off \dot@spacing
    }
}
\makeatother

%%% Таблицы
\usepackage{tabularx}
\newcolumntype{L}[1]{>{\hsize=#1\hsize\raggedright\arraybackslash}X}%
\newcolumntype{R}[1]{>{\hsize=#1\hsize\raggedleft\arraybackslash}X}%
\newcolumntype{C}[1]{>{\hsize=#1\hsize\centering\arraybackslash}X}


%%% Нумерованные списки
\usepackage{enumitem}
\setlist[enumerate]{itemsep=1pt, label={\arabic*.}, leftmargin=1pc}


%%% Новые команды
\newcommand{\term}[1]{\,\!{\sffamily\bfseries#1}}
\newcommand{\moon}{\!\!\rightmoon}
\newcommand{\au}{\text{а.\,е.}}
\newcommand{\tw}{\textwidth}
\newcommand{\imp}[1]{{\itshape#1}}

\newcommand{\change}[1]{\textcolor{red}{#1}}

\newcommand*{\SectorRadius}{1ex}
\newcommand*{\SectorHalfAngle}{40}
\newcommand*{\SectorLineWidth}{.5pt}


\newcommand{\picRef}[1]{Рис.\;\ref{#1}}
\newcommand{\lookPicRef}[1]{см.~\picRef{#1}}

\newcommand*{\sector}{%
    \begin{pgfpicture}
        \pgfpathmoveto{\pgforigin}%
        \pgfpathlineto{\pgfpointpolar{90-(\SectorHalfAngle)}{\SectorRadius}}%
        \pgfarc{90-(\SectorHalfAngle)}{90+\SectorHalfAngle}{\SectorRadius}%
        \pgfpathclose
        \pgfsetlinewidth{\SectorLineWidth}%
        \pgfusepath{stroke}%
    \end{pgfpicture}%
}


%%% Cчетчики
\renewcommand{\theequation}{\thesection.\arabic{equation}}
\numberwithin{equation}{section}


%%% Размеры
\setlength {\parskip} { 4pt }
%\setlength {\parindent} { 0pt }
\renewcommand {\baselinestretch}{ 1.02 }


%%% Гиперссылки
\usepackage{hyperref}
\hypersetup	{
    colorlinks=false,
    linktoc=all
}


%%% Колонтитулы
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\fancyhead[CO]{\slshape \small \leftmark}
\fancyhead[LE, RO]{\slshape \small \thepage}
\fancyhead[CE]{\slshape \hyperref[toc]{Астрадь}}


\usepackage{url}

%%% main
\begin{document}
%\includepdf[pages=-]{sys/empty-page.pdf}
    \input{sys/cover}
%	\input{sys/title}
	\input{sys/authors}
	\setcounter{tocdepth}{2}
	{
		\small
		\renewcommand{\baselinestretch}{ 0.95 }
		\tableofcontents
		\label{toc}
		\renewcommand {\baselinestretch}{ 1.02 }
	}
	\newpage
	\input{sys/cel.mech.tex}
	\input{sys/conic.sec.tex}
	\input{sys/astrophys.tex}
	\input{sys/cosmology.tex}
	\input{sys/optic.tex}
	\input{sys/spher.astro.tex}
	\input{sys/objects.tex}
	\input{sys/maths.tex}
	\input{sys/prac-astro.tex}
	\input{sys/tables.tex}
	\input{sys/notes.tex}
	
	\bibliographystyle{ieeetr}
	\bibliography{lit}
	\input{sys/print-info.tex}

\end{document}
