(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[     87557,       1895]
NotebookOptionsPosition[     84705,       1848]
NotebookOutlinePosition[     85101,       1864]
CellTagsIndexPosition[     85058,       1861]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Double star light curve", "Title",
 CellChangeTimes->{{3.927445609610132*^9, 
  3.9274456191828747`*^9}},ExpressionUUID->"b7f4011e-e9d4-46b3-b2ab-\
03faecbdfd2a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Get", "[", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], ",", 
      "\"\<ExportToCSV.wl\>\""}], "}"}], "]"}], "]"}], ";"}]], "Input",
 CellLabel->"In[12]:=",ExpressionUUID->"db952e11-ccf7-46c2-b20e-50c6fa6c124a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"a", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"i", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M1", " ", "=", " ", "3.2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M2", " ", "=", " ", "1.8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R1", " ", "=", " ", "2.7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R2", " ", "=", "1.7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R3", " ", "=", " ", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T1", " ", "=", " ", "13000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T2", "=", " ", "7500"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T3", "=", "5500"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ec", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"N0", "=", "1000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"size", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a1", "=", 
   RowBox[{
    RowBox[{"-", "a"}], "*", 
    FractionBox["M2", 
     RowBox[{"M1", "+", "M2"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a2", "=", 
   RowBox[{"a", "*", 
    FractionBox["M1", 
     RowBox[{"M1", "+", "M2"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Omega]", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r", "[", 
    RowBox[{"a_", ",", "w_", ",", "j_"}], "]"}], ":=", " ", 
   FractionBox[
    RowBox[{"a", "*", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "-", "w"}], ")"}], "2"]}], 
    RowBox[{"1", "+", 
     RowBox[{"w", "*", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Phi]0", "[", "j", "]"}], "]"}]}]}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]0", "[", "t_", "]"}], ":=", 
   RowBox[{"2", "Pi", "*", "t"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Grsph", "[", 
    RowBox[{
    "a1_", ",", " ", "a2_", ",", " ", "R1_", ",", " ", "R2_", ",", " ", 
     "t_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Blue", ",", 
         RowBox[{"Sphere", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a1", "*", 
              RowBox[{"Cos", "[", 
               RowBox[{"\[Phi]0", "[", "t", "]"}], "]"}]}], ",", 
             RowBox[{"a1", "*", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Phi]0", "[", "t", "]"}], "]"}]}], ",", "0"}], "}"}],
            ",", "R1"}], " ", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Red", ",", 
         RowBox[{"Sphere", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a2", "*", 
              RowBox[{"Cos", "[", 
               RowBox[{"\[Phi]0", "[", "t", "]"}], "]"}]}], ",", 
             RowBox[{"a2", "*", 
              RowBox[{"Sin", "[", 
               RowBox[{"\[Phi]0", "[", "t", "]"}], "]"}]}], ",", "0"}], "}"}],
            ",", "R2"}], " ", "]"}]}], "}"}]}], "}"}], ",", " ", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "size"}], ",", " ", "size"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "size"}], ",", " ", "size"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "size"}], ",", " ", "size"}], "}"}]}], "}"}]}], " ", 
     ",", 
     RowBox[{"Lighting", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"\"\<Ambient\>\"", ",", "White"}], "}"}], "}"}]}], ",", 
     RowBox[{"ViewPoint", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "Infinity", ",", "0"}], "}"}]}], ",", " ", 
     RowBox[{"Boxed", "\[Rule]", "False"}], ",", " ", 
     RowBox[{"Background", "\[Rule]", "White"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
     RowBox[{"SphericalRegion", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Grsph", "[", 
  RowBox[{"a1", ",", "a2", ",", "R1", ",", "R2", ",", "0"}], "]"}]}], "Input",\

 CellChangeTimes->{{3.67628863033814*^9, 3.6762886552004023`*^9}, {
   3.676288727242873*^9, 3.676288740057185*^9}, {3.676288790792642*^9, 
   3.676288857713603*^9}, {3.676288889227728*^9, 3.676288890802248*^9}, {
   3.67628893793298*^9, 3.676288959484264*^9}, {3.6762890104949007`*^9, 
   3.67628922291113*^9}, {3.676289347951374*^9, 3.6762894837121077`*^9}, {
   3.6762895643530893`*^9, 3.6762896452015676`*^9}, {3.676289676972423*^9, 
   3.67628974848733*^9}, {3.6762901117037773`*^9, 3.676290146407423*^9}, {
   3.676296679227504*^9, 3.676296885191876*^9}, {3.6762970246896353`*^9, 
   3.676297064739542*^9}, {3.676297096803801*^9, 3.676297119336493*^9}, {
   3.6762971560986853`*^9, 3.676297256344097*^9}, {3.676297294928523*^9, 
   3.676297373629159*^9}, {3.6762975462092037`*^9, 3.676297558479467*^9}, {
   3.676297644573704*^9, 3.676297784044198*^9}, {3.676297818734272*^9, 
   3.6762978681726*^9}, {3.676297903608601*^9, 3.676297949196939*^9}, {
   3.676298076317684*^9, 3.676298108122706*^9}, {3.676298147813236*^9, 
   3.6762981702298*^9}, {3.676298200668935*^9, 3.676298319067848*^9}, {
   3.676298358791335*^9, 3.676298406584765*^9}, {3.6762984560059423`*^9, 
   3.676298596184567*^9}, {3.67629862653463*^9, 3.676298723613748*^9}, {
   3.676298771427803*^9, 3.6762988423541183`*^9}, {3.676298885129842*^9, 
   3.676298907072167*^9}, {3.676298942754881*^9, 3.676298945590905*^9}, {
   3.676298990408174*^9, 3.676299124042542*^9}, {3.6762991712723513`*^9, 
   3.676299266386243*^9}, {3.676299310281515*^9, 3.676299473424534*^9}, {
   3.6762995593207493`*^9, 3.676299563217785*^9}, {3.676299605074293*^9, 
   3.676299609107316*^9}, {3.6762996951817627`*^9, 3.676299698557596*^9}, {
   3.676299775732073*^9, 3.676299833090673*^9}, {3.6762998701470747`*^9, 
   3.6762998729759607`*^9}, {3.676299924346776*^9, 3.676300052673212*^9}, {
   3.676300100554242*^9, 3.676300112007975*^9}, {3.676300163142062*^9, 
   3.6763001658522453`*^9}, {3.676300279188645*^9, 3.67630028833908*^9}, {
   3.6763004601943073`*^9, 3.6763004655462427`*^9}, {3.676300553880466*^9, 
   3.6763005615892*^9}, {3.6763005969660807`*^9, 3.6763005971720667`*^9}, {
   3.6763006389095716`*^9, 3.676300644842559*^9}, {3.67630075719042*^9, 
   3.676300757331937*^9}, {3.676300816120894*^9, 3.676300827153284*^9}, {
   3.676300971470333*^9, 3.6763009906427107`*^9}, {3.676301024672258*^9, 
   3.676301031404855*^9}, {3.6763010979374313`*^9, 3.676301099719617*^9}, {
   3.676301131690872*^9, 3.676301142663621*^9}, {3.676301354769312*^9, 
   3.676301367021994*^9}, {3.676301556703579*^9, 3.676301563020028*^9}, {
   3.676301649827426*^9, 3.676301876598343*^9}, 3.676301910917207*^9, {
   3.676301946774674*^9, 3.6763019842518873`*^9}, {3.6763021385031443`*^9, 
   3.676302138565413*^9}, {3.676302194944004*^9, 3.676302195141213*^9}, {
   3.6763022764731007`*^9, 3.676302279949182*^9}, {3.676302320942266*^9, 
   3.67630233995383*^9}, {3.676302503346897*^9, 3.6763026697888737`*^9}, {
   3.676302717134355*^9, 3.676302731617371*^9}, {3.676302775873089*^9, 
   3.676302780461123*^9}, 3.676302816891665*^9, {3.676302850392976*^9, 
   3.676302862042095*^9}, {3.676303027087678*^9, 3.676303111396936*^9}, {
   3.676303162267377*^9, 3.676303170219656*^9}, {3.676303251036695*^9, 
   3.676303278060285*^9}, {3.676306984869506*^9, 3.6763070581610622`*^9}, {
   3.676309167357464*^9, 3.6763091707627277`*^9}, {3.676309226692029*^9, 
   3.676309276042988*^9}, {3.6763093143756857`*^9, 3.676309431541831*^9}, {
   3.676309561465371*^9, 3.6763095631452503`*^9}, {3.676310649213545*^9, 
   3.6763109815989122`*^9}, {3.676311018728607*^9, 3.67631106304698*^9}, {
   3.6763111025253267`*^9, 3.6763112011075163`*^9}, {3.6763113103015223`*^9, 
   3.676311329254717*^9}, {3.676311397944339*^9, 3.676311424295568*^9}, {
   3.6763118492305717`*^9, 3.676311926723564*^9}, {3.676336639198266*^9, 
   3.676336715842622*^9}, {3.676336761961425*^9, 3.6763367620204697`*^9}, {
   3.676336880704204*^9, 3.676336881044052*^9}, {3.6763369174517317`*^9, 
   3.676336941964876*^9}, {3.676337017723794*^9, 3.676337017980426*^9}, {
   3.676337055347156*^9, 3.67633705595877*^9}, {3.676337140259851*^9, 
   3.676337198784677*^9}, {3.676337270301317*^9, 3.676337279619079*^9}, {
   3.676337336056182*^9, 3.676337357174757*^9}, {3.6763378296470222`*^9, 
   3.676337902917688*^9}, {3.6763379376725597`*^9, 3.676337970068705*^9}, {
   3.6763380101643972`*^9, 3.6763380609156113`*^9}, {3.676338097337447*^9, 
   3.676338097479726*^9}, {3.6763381742128067`*^9, 3.67633817992951*^9}, {
   3.676338315502635*^9, 3.676338315652062*^9}, {3.6763383634322357`*^9, 
   3.676338382310083*^9}, {3.676338449936768*^9, 3.676338470943655*^9}, {
   3.67633853021064*^9, 3.676338544816782*^9}, {3.6763385816650667`*^9, 
   3.676338624766728*^9}, {3.6763629514182034`*^9, 3.676363063115953*^9}, {
   3.67636320623734*^9, 3.67636322473701*^9}, {3.6763633076937857`*^9, 
   3.676363327633765*^9}, {3.6763633629866047`*^9, 3.6763633691208477`*^9}, {
   3.6763634580312347`*^9, 3.676363486787087*^9}, {3.6763635417263107`*^9, 
   3.676363557197021*^9}, {3.676363593922119*^9, 3.676363594057744*^9}, {
   3.676363640886742*^9, 3.67636365505942*^9}, {3.676363697674716*^9, 
   3.676363698875094*^9}, {3.676363806852229*^9, 3.676363842170659*^9}, {
   3.6763641453121347`*^9, 3.676364152625296*^9}, {3.6763647820516157`*^9, 
   3.676364793625201*^9}, {3.676364835055088*^9, 3.676364835224888*^9}, {
   3.676364878228907*^9, 3.676364881134251*^9}, {3.676365139091093*^9, 
   3.676365223535605*^9}, {3.6763654422845984`*^9, 3.676365443597801*^9}, {
   3.676365521311921*^9, 3.676365538957901*^9}, {3.6763656322922792`*^9, 
   3.6763656408269653`*^9}, {3.676365702450775*^9, 3.676365878962895*^9}, {
   3.676366090250163*^9, 3.67636609295074*^9}, {3.6763663634362297`*^9, 
   3.676366489430407*^9}, {3.676366547197063*^9, 3.6763665743523197`*^9}, {
   3.67636733713555*^9, 3.676367362592394*^9}, {3.676369010603716*^9, 
   3.676369105388351*^9}, {3.6763691464035187`*^9, 3.67636916055895*^9}, {
   3.676369554082741*^9, 3.6763696016453037`*^9}, {3.676369694465769*^9, 
   3.67636969687497*^9}, {3.6763697718395977`*^9, 3.6763697731197023`*^9}, {
   3.6763737847453413`*^9, 3.676373788320572*^9}, {3.676373899644415*^9, 
   3.6763739066640987`*^9}, {3.6764606666634207`*^9, 3.676460748494334*^9}, 
   3.676460800566338*^9, {3.676460842244323*^9, 3.676460856667323*^9}, {
   3.676460922892695*^9, 3.6764609584578533`*^9}, {3.676544387073758*^9, 
   3.676544387331071*^9}, {3.676544419692498*^9, 3.676544439230033*^9}, {
   3.676544636721324*^9, 3.676544636753688*^9}, {3.676544675403576*^9, 
   3.676544732122386*^9}, {3.676544828416753*^9, 3.676544838486332*^9}, {
   3.6765449649264517`*^9, 3.676544973966751*^9}, {3.676545102831107*^9, 
   3.676545103085458*^9}, {3.676604345853916*^9, 3.676604363867532*^9}, {
   3.6766044847379427`*^9, 3.676604546199663*^9}, {3.676604582628434*^9, 
   3.6766046094168587`*^9}, 3.676604642487151*^9, {3.676605066245612*^9, 
   3.676605069995982*^9}, {3.676623551942124*^9, 3.676623567340435*^9}, {
   3.676693887314535*^9, 3.676693903886298*^9}, {3.6766940740634403`*^9, 
   3.6766940952948713`*^9}, {3.67669433968321*^9, 3.6766943465907583`*^9}, {
   3.676694406859953*^9, 3.676694407530631*^9}, {3.676694535158988*^9, 
   3.676694535212772*^9}, {3.676694646419148*^9, 3.676694649082045*^9}, {
   3.676694797335698*^9, 3.676694853048027*^9}, {3.676694913657689*^9, 
   3.676694913815346*^9}, {3.676694980188931*^9, 3.6766949819564037`*^9}, {
   3.676695069828847*^9, 3.676695073443493*^9}, {3.67669522701376*^9, 
   3.676695246723507*^9}, {3.676701909440885*^9, 3.676701928781177*^9}, {
   3.676702072017972*^9, 3.676702088066991*^9}, {3.6767022878522253`*^9, 
   3.676702293193853*^9}, {3.676702735828824*^9, 3.6767027732060204`*^9}, {
   3.676702828874793*^9, 3.6767028621045837`*^9}, {3.676703185821127*^9, 
   3.6767031862998037`*^9}, {3.676703216834351*^9, 3.676703217397368*^9}, {
   3.676703729964097*^9, 3.676703730424285*^9}, {3.6767039985040493`*^9, 
   3.676703998660521*^9}, {3.676704440829319*^9, 3.676704450031917*^9}, {
   3.676704587510518*^9, 3.676704592965152*^9}, {3.6767048680529823`*^9, 
   3.6767048681792393`*^9}, {3.676704899591701*^9, 3.676704969106875*^9}, 
   3.6767051253491993`*^9, {3.676708452588789*^9, 3.6767084527554626`*^9}, {
   3.6767085737100267`*^9, 3.6767085748124657`*^9}, {3.676708605048316*^9, 
   3.67670861806872*^9}, {3.6767089092535973`*^9, 3.676708938268117*^9}, {
   3.6767090170513783`*^9, 3.676709017481741*^9}, {3.676709136844738*^9, 
   3.6767091677983522`*^9}, {3.676709413864648*^9, 3.6767094164476147`*^9}, {
   3.6767096974294147`*^9, 3.676709697603236*^9}, {3.67670987959638*^9, 
   3.676709965800921*^9}, {3.676710203576426*^9, 3.676710254696052*^9}, {
   3.6767103005909*^9, 3.6767103032463493`*^9}, {3.6767109671253233`*^9, 
   3.6767109677933197`*^9}, {3.6767110240815983`*^9, 
   3.6767110243587437`*^9}, {3.676711055118051*^9, 3.676711069049974*^9}, {
   3.676711120509321*^9, 3.676711127563469*^9}, {3.6767111794202137`*^9, 
   3.6767111915819273`*^9}, {3.676711228875792*^9, 3.676711233109095*^9}, 
   3.676711282293397*^9, {3.676711363375482*^9, 3.676711446172608*^9}, {
   3.676711949438093*^9, 3.676711949708596*^9}, {3.676712094276927*^9, 
   3.6767121097302732`*^9}, {3.676712140210696*^9, 3.6767121424428864`*^9}, {
   3.676712271113366*^9, 3.676712307864689*^9}, {3.676712592620695*^9, 
   3.676712592762785*^9}, {3.676712767340602*^9, 3.676712767691349*^9}, {
   3.6767136021423197`*^9, 3.6767136073611383`*^9}, {3.676713805354403*^9, 
   3.67671380564793*^9}, {3.676713961507015*^9, 3.6767139625609283`*^9}, {
   3.6767736391861143`*^9, 3.676773667081325*^9}, {3.676773896394272*^9, 
   3.6767739277831163`*^9}, {3.676773990919053*^9, 3.676773991021103*^9}, {
   3.676774226279085*^9, 3.676774271211453*^9}, {3.676774377755898*^9, 
   3.6767743819424067`*^9}, {3.67677482883856*^9, 3.67677484802743*^9}, {
   3.676775715014111*^9, 3.676775722258703*^9}, {3.6767759056825457`*^9, 
   3.6767759435058947`*^9}, {3.6767759802628613`*^9, 3.67677598221994*^9}, {
   3.676777441582397*^9, 3.6767774472111473`*^9}, {3.67677749834377*^9, 
   3.6767775143090076`*^9}, {3.676780012709976*^9, 3.6767800454616623`*^9}, {
   3.6767886857097054`*^9, 3.676788717141526*^9}, {3.67678876891565*^9, 
   3.676788785743965*^9}, {3.676901308835565*^9, 3.676901502556601*^9}, {
   3.676901940833877*^9, 3.676901964031414*^9}, {3.676902012705689*^9, 
   3.6769020828005657`*^9}, {3.6769021376603727`*^9, 3.676902192173933*^9}, {
   3.676902243385593*^9, 3.676902243520124*^9}, 3.676902330939516*^9, {
   3.676902363975215*^9, 3.676902369927484*^9}, {3.6769024103232603`*^9, 
   3.676902421203245*^9}, {3.6769024512474937`*^9, 3.676902451344145*^9}, {
   3.676902609919161*^9, 3.676902611597123*^9}, {3.6769028244479713`*^9, 
   3.676902833306967*^9}, {3.6769029506911182`*^9, 3.6769029814415283`*^9}, {
   3.6769032601951427`*^9, 3.6769032618756647`*^9}, {3.676903616339211*^9, 
   3.676903643378005*^9}, {3.6769036959579363`*^9, 3.676903728490686*^9}, {
   3.676903989155323*^9, 3.676904005131248*^9}, {3.676904536100965*^9, 
   3.676904544755933*^9}, {3.677216443247074*^9, 3.677216451986363*^9}, {
   3.6772171113544827`*^9, 3.677217112089682*^9}, {3.677217584122134*^9, 
   3.6772175844879847`*^9}, {3.6772223134566813`*^9, 
   3.6772224196810913`*^9}, {3.67722245169203*^9, 3.6772224649209633`*^9}, {
   3.677226977428171*^9, 3.6772271506607437`*^9}, {3.6772279095514097`*^9, 
   3.677227991128154*^9}, {3.723618945937819*^9, 3.723618988245742*^9}, {
   3.723619069999976*^9, 3.723619148724989*^9}, {3.723619234843462*^9, 
   3.7236192375290937`*^9}, {3.7236194313652163`*^9, 
   3.7236194353955936`*^9}, {3.7236197128629923`*^9, 3.723619752459749*^9}, {
   3.723619977483622*^9, 3.723619978112185*^9}, {3.723620024066124*^9, 
   3.723620222538191*^9}, {3.723620287540682*^9, 3.723620335310907*^9}, {
   3.7236203906305723`*^9, 3.7236204041234407`*^9}, {3.723620445805399*^9, 
   3.723620514153819*^9}, {3.7236205907628937`*^9, 3.723620609864542*^9}, {
   3.7236206456402807`*^9, 3.723620734546091*^9}, {3.723620831491942*^9, 
   3.723620831781823*^9}, {3.8857930493720837`*^9, 3.885793053437744*^9}, {
   3.885793891238719*^9, 3.885793904940895*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"1bab7617-b89c-42e3-bb69-e39a3242625f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"curv", " ", "=", 
   RowBox[{"Parallelize", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"t", "+", 
         FractionBox["\[Omega]", "360"]}], ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             FractionBox["T1", "T2"], ")"}], "4"], "*", 
           RowBox[{"Length", "@", 
            RowBox[{"PixelValuePositions", "[", 
             RowBox[{
              RowBox[{"Grsph", "[", 
               RowBox[{"a1", ",", "a2", ",", "R1", ",", "R2", ",", "t"}], 
               "]"}], ",", " ", "Blue", ",", "0.5"}], "]"}]}]}], "+", 
          RowBox[{"Length", "@", 
           RowBox[{"PixelValuePositions", "[", 
            RowBox[{
             RowBox[{"Grsph", "[", 
              RowBox[{"a1", ",", "a2", ",", "R1", ",", "R2", ",", "t"}], 
              "]"}], ",", " ", "Red", ",", "0.5"}], "]"}]}]}], ")"}]}], "}"}],
       ",", " ", 
      RowBox[{"{", 
       RowBox[{"t", ",", " ", "0", ",", " ", "1", ",", " ", "0.005"}], 
       "}"}]}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.676703382289463*^9, 3.67670338521381*^9}, {
   3.676704464370227*^9, 3.6767044644537077`*^9}, {3.67670469068009*^9, 
   3.67670469309144*^9}, 3.676705013912829*^9, 3.6767093307161407`*^9, 
   3.6767095128672743`*^9, {3.676710263323977*^9, 3.676710273532443*^9}, {
   3.676710407374318*^9, 3.676710410945664*^9}, 3.676710460725411*^9, {
   3.67671052927166*^9, 3.676710529368997*^9}, {3.67671160869838*^9, 
   3.676711653453699*^9}, {3.6767118165369473`*^9, 3.676711829497773*^9}, {
   3.676712442228332*^9, 3.676712443527557*^9}, {3.676774410442573*^9, 
   3.676774443054517*^9}, {3.6767746398748283`*^9, 3.676774642783614*^9}, {
   3.676904017980419*^9, 3.6769040934209414`*^9}, {3.676904268713984*^9, 
   3.6769042693319283`*^9}, {3.677212751354518*^9, 3.677212752626927*^9}, {
   3.677212914567309*^9, 3.677212917709917*^9}, {3.677213028985615*^9, 
   3.677213029502192*^9}, {3.72361920087982*^9, 3.723619216393641*^9}, {
   3.7236193013974133`*^9, 3.7236193411931343`*^9}, {3.723619443783986*^9, 
   3.72361944637016*^9}, {3.7236194786801443`*^9, 3.7236195372360363`*^9}, {
   3.72361957002111*^9, 3.723619570257695*^9}, {3.723620841070755*^9, 
   3.723620860622641*^9}, {3.723621027659829*^9, 3.723621036611547*^9}, {
   3.7236214561861753`*^9, 3.7236214644393253`*^9}, {3.885793144756969*^9, 
   3.885793149828277*^9}, 3.885793201199423*^9, {3.8857939122399406`*^9, 
   3.885793915107375*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"4f9758ef-d1f4-4698-992e-788854f478a1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"max", "=", 
   RowBox[{"N", "[", 
    RowBox[{"Max", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"curv", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "@", "curv"}]}], "}"}]}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"curvl", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"SetPrecision", "[", 
        RowBox[{
         RowBox[{"curv", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "3"}], "]"}], ",", 
       RowBox[{"Round", "[", 
        RowBox[{
         RowBox[{"SetPrecision", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2.5"}], 
            RowBox[{"Log10", "[", 
             RowBox[{
              RowBox[{"curv", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2"}], "]"}], "]"}], "/", "max"}], "]"}]}], 
           ",", "3"}], "]"}], ",", "0.001"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "200", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"TableForm", "[", 
    RowBox[{"N", "[", "curvl", "]"}], "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.723621058380747*^9, 3.723621151027141*^9}, {
  3.723621262712696*^9, 3.7236212685245523`*^9}, {3.723621310089033*^9, 
  3.723621317528719*^9}, {3.723621373250132*^9, 3.7236214054691887`*^9}, {
  3.7236214748215933`*^9, 3.723621474885708*^9}, {3.723621616103993*^9, 
  3.72362176433729*^9}, {3.885793462603253*^9, 3.8857935040257072`*^9}, {
  3.885793587372588*^9, 3.885793657465225*^9}, {3.8857937645828247`*^9, 
  3.885793798680538*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"0a37df63-3d2d-4a5a-b3eb-3e0affb67df8"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"-", "curvl"}], ",", 
   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
   RowBox[{"InterpolationOrder", "\[Rule]", "3"}], ",", 
   RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", " ", 
   RowBox[{"AspectRatio", "\[Rule]", 
    RowBox[{"1", "/", "2"}]}], ",", 
   RowBox[{"FrameStyle", "\[Rule]", 
    RowBox[{"Thickness", "[", "Medium", "]"}]}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", "Black"}], ",", " ", 
   RowBox[{"ImageSize", "\[Rule]", "600"}], ",", " ", 
   RowBox[{"PlotRange", "\[Rule]", "Full"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.676604615949348*^9, 3.6766046908667793`*^9}, {
   3.676694623742003*^9, 3.6766946341521893`*^9}, {3.676694862893333*^9, 
   3.676694884435788*^9}, {3.676694976652504*^9, 3.676694977282229*^9}, {
   3.676695082028866*^9, 3.676695082180521*^9}, {3.676695168890003*^9, 
   3.676695196344729*^9}, {3.6766956683496237`*^9, 3.676695672877118*^9}, {
   3.676702223145582*^9, 3.67670222795557*^9}, {3.676702355748402*^9, 
   3.676702382881846*^9}, {3.676704469819607*^9, 3.676704469995161*^9}, {
   3.6767045580859203`*^9, 3.676704561689733*^9}, {3.67670477017413*^9, 
   3.6767047725188227`*^9}, {3.676710307906084*^9, 3.676710307960246*^9}, {
   3.676710531638492*^9, 3.6767105317681923`*^9}, {3.6767745592835817`*^9, 
   3.676774587880954*^9}, {3.676774715963768*^9, 3.676774716027018*^9}, {
   3.676892701092339*^9, 3.676892701212392*^9}, {3.676904197051825*^9, 
   3.676904208877796*^9}, {3.676904424292897*^9, 3.676904425402321*^9}, {
   3.677212804778837*^9, 3.677212807843557*^9}, {3.677212976664809*^9, 
   3.6772130107822037`*^9}, {3.677213502244961*^9, 3.677213519339403*^9}, {
   3.67721368168787*^9, 3.6772136851737747`*^9}, {3.677214657286778*^9, 
   3.677214657798068*^9}, 3.723619456288067*^9, {3.723619522693101*^9, 
   3.723619522947147*^9}, {3.72361955693137*^9, 3.7236195571206417`*^9}, {
   3.723621413383733*^9, 3.7236214389834633`*^9}, {3.723621749833909*^9, 
   3.7236217792324*^9}, {3.885793292626629*^9, 3.885793332637636*^9}, {
   3.885793811705895*^9, 3.88579382537908*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"92ead85a-9cd5-4c2e-8a1f-3e66f6c3180e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExportToCSV", "[", 
   RowBox[{
    RowBox[{"TableWithTitle", "[", 
     RowBox[{"curvl", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<t\>\"", ",", " ", "\"\<m\>\""}], "}"}]}], "]"}], ",", 
    RowBox[{"DataFileName", "[", "\"\<light-curve-B-Per.csv\>\"", "]"}]}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.67721339382386*^9, 3.677213397142481*^9}, {
   3.677213428204895*^9, 3.677213434736912*^9}, {3.677213527128264*^9, 
   3.6772135392956*^9}, 3.677213604646123*^9, {3.677213689509137*^9, 
   3.677213717857257*^9}, {3.677214594436698*^9, 3.677214595670298*^9}, {
   3.6772147256248617`*^9, 3.6772147370483418`*^9}, {3.677215244803491*^9, 
   3.677215244913238*^9}, {3.677215444762384*^9, 3.677215444888852*^9}, {
   3.677216851555524*^9, 3.6772168516825247`*^9}, {3.885793423948943*^9, 
   3.88579344598071*^9}, {3.885793681976912*^9, 3.885793737573135*^9}, 
   3.885793835538641*^9, {3.92744564800667*^9, 3.927445680160269*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"dffb5650-60d6-43d6-b5ac-8f31d853d145"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"w", "=", 
     RowBox[{"Graphics3D", "[", 
      RowBox[{
       RowBox[{"{", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"LightGray", ",", 
           RowBox[{"Sphere", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "a1"}], ",", "0", ",", "0"}], "}"}], ",", 
             RowBox[{"R1", "*", "1.5"}]}], " ", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Gray", ",", 
           RowBox[{"Sphere", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "a2"}], ",", "0", ",", "0"}], "}"}], ",", 
             RowBox[{"R2", "*", "1.5"}]}], " ", "]"}]}], "}"}]}], "}"}], ",", 
       " ", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "size"}], ",", " ", "size"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "size"}], ",", " ", "size"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "size"}], ",", " ", "size"}], "}"}]}], "}"}]}], " ", 
       ",", 
       RowBox[{"Lighting", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"\"\<Directional\>\"", ",", "White", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "2"}], ",", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "}"}], 
         "}"}]}], ",", 
       RowBox[{"ViewPoint", "\[Rule]", "Front"}], ",", " ", 
       RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "1200"}], ",", 
       RowBox[{"SphericalRegion", "\[Rule]", "True"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"exportImage", "=", 
    RowBox[{"Lighter", "[", 
     RowBox[{
      RowBox[{"ImageAdjust", "[", 
       RowBox[{
        RowBox[{"RemoveBackground", "[", 
         RowBox[{"ImageTrim", "[", 
          RowBox[{
           RowBox[{"Rasterize", "[", "w", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"560", ",", "900"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1750", ",", "1500"}], "}"}]}], "}"}]}], "]"}], "]"}], 
        ",", 
        RowBox[{"-", "0.4"}]}], "]"}], ",", "0.3"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<..\>\"", ",", 
         "\"\<img\>\"", ",", "\"\<b-per.png\>\""}], "}"}], "]"}], ",", 
      "exportImage"}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.885796048898355*^9, 3.8857962453786497`*^9}, {
  3.885796293263735*^9, 3.88579633570621*^9}, {3.885796378796913*^9, 
  3.885796517030725*^9}, {3.885796662575029*^9, 3.885796810091638*^9}, {
  3.885796921405373*^9, 3.885796976873179*^9}, {3.885797020299347*^9, 
  3.885797256330626*^9}, {3.8857972930545883`*^9, 3.885797293142242*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"337e3b12-fbef-43c2-a7d9-49a2e78aff25"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.67646090222817*^9, 3.6764609085815372`*^9}},
 CellLabel->
  "In[581]:=",ExpressionUUID->"6bbaf767-54db-48b1-a34f-8707d819516c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"a", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"i", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M1", " ", "=", " ", "7.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M2", " ", "=", " ", "7.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R1", " ", "=", " ", "19"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R2", " ", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T1", " ", "=", " ", "8000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T2", "=", " ", "13000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ec", " ", "=", " ", "0.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x1", " ", "=", " ", 
   RowBox[{"-", "50"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x2", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y1", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y2", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"z1", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"z2", " ", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"size", "=", "70"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xc", " ", "=", " ", 
   RowBox[{"x1", " ", "+", 
    RowBox[{
     RowBox[{"(", " ", 
      RowBox[{"x2", "-", "x1"}], ")"}], "*", 
     FractionBox["M2", 
      RowBox[{"M1", "+", "M2"}]]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yc", " ", "=", 
   RowBox[{"y1", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"y2", "-", "y1"}], ")"}], "*", 
     FractionBox["M2", 
      RowBox[{"M1", "+", "M2"}]]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zc", "=", "0"}], ";"}]}], "Input",
 CellChangeTimes->{{3.676457173956596*^9, 3.676457491243602*^9}, {
   3.676457552092285*^9, 3.676457570794736*^9}, {3.6764576173671827`*^9, 
   3.676457658691574*^9}, {3.676457865767721*^9, 3.67645792238699*^9}, {
   3.676457960177593*^9, 3.676458030130595*^9}, {3.676458063055647*^9, 
   3.676458063276194*^9}, {3.676458172823188*^9, 3.6764581974638453`*^9}, {
   3.676458232487108*^9, 3.676458453939522*^9}, {3.6764584847424994`*^9, 
   3.676458484967392*^9}, {3.6764585366563807`*^9, 3.676458555693852*^9}, {
   3.676458600832323*^9, 3.676458695528305*^9}, {3.6764587324375257`*^9, 
   3.676458964905037*^9}, {3.676459943140485*^9, 3.676459977130295*^9}, {
   3.676460563767744*^9, 3.676460566283453*^9}, {3.6764612461265707`*^9, 
   3.676461323528019*^9}, {3.676461358308157*^9, 3.676461500742168*^9}, {
   3.676461671421631*^9, 3.67646167683575*^9}, {3.6764618652452583`*^9, 
   3.67646196981113*^9}, {3.676462012054061*^9, 3.676462136405546*^9}, {
   3.676462175109786*^9, 3.676462194855711*^9}, {3.676462580511024*^9, 
   3.676462580841631*^9}, {3.676462699144706*^9, 3.6764627394170647`*^9}, {
   3.676462824032468*^9, 3.676462824737071*^9}, {3.676462873638769*^9, 
   3.67646293083327*^9}, {3.676483479589981*^9, 3.676483496606052*^9}, {
   3.676483536810607*^9, 3.6764835740862226`*^9}, {3.676485391291258*^9, 
   3.6764854629342327`*^9}, {3.6764854947857847`*^9, 3.676485496872099*^9}, {
   3.676485702374797*^9, 3.676485704999723*^9}, 3.676485794213129*^9, {
   3.676485846411422*^9, 3.676485853402976*^9}, {3.676485914706501*^9, 
   3.6764859440495977`*^9}, {3.676485997465846*^9, 3.676486018570496*^9}, {
   3.6764860745879097`*^9, 3.676486075444957*^9}, {3.6764861458826103`*^9, 
   3.6764861596977386`*^9}, {3.676511494823476*^9, 3.676511496971218*^9}, {
   3.6765115933819733`*^9, 3.6765116197375917`*^9}, {3.67651166257942*^9, 
   3.676511666266509*^9}, {3.6765117561623898`*^9, 3.6765117628563213`*^9}, {
   3.676511854336492*^9, 3.6765118553106956`*^9}, {3.6765119003692503`*^9, 
   3.67651198804921*^9}, {3.676512032396192*^9, 3.676512150296041*^9}, {
   3.676512206687216*^9, 3.676512220108457*^9}, {3.676512259241715*^9, 
   3.676512280642744*^9}, {3.676512337505814*^9, 3.6765123410800962`*^9}, {
   3.676512390338334*^9, 3.676512407310687*^9}, {3.676512471652937*^9, 
   3.6765125068496323`*^9}, {3.676512553525599*^9, 3.676512557060087*^9}, {
   3.676512601531638*^9, 3.676512630895247*^9}, {3.676529532119575*^9, 
   3.676529551308208*^9}, {3.676529587146002*^9, 3.676529587272131*^9}, {
   3.676529724126478*^9, 3.676529825877755*^9}, {3.676531225299466*^9, 
   3.6765313215512657`*^9}, {3.676531398636216*^9, 3.676531405206069*^9}, {
   3.6766333134972687`*^9, 3.676633346984105*^9}, {3.6766336335051622`*^9, 
   3.676633634367852*^9}, {3.676633815198419*^9, 3.676633819483934*^9}, {
   3.676653312243287*^9, 3.6766533172913523`*^9}, {3.676692712120428*^9, 
   3.676692713110422*^9}, {3.676692767344241*^9, 3.676692767495816*^9}, {
   3.676795068117978*^9, 3.6767950880196133`*^9}, {3.6767955194759283`*^9, 
   3.67679552168004*^9}, {3.6767955621344137`*^9, 3.6767955684598217`*^9}, {
   3.676796921439253*^9, 3.676796921581472*^9}, {3.676796963557104*^9, 
   3.676796966555122*^9}, {3.6767979630246983`*^9, 3.676797965911077*^9}, {
   3.677045166726016*^9, 3.677045168917433*^9}, {3.6770556924288683`*^9, 
   3.677055703291057*^9}, {3.677056133015834*^9, 3.67705613391922*^9}, {
   3.677056828382597*^9, 3.677056831149032*^9}, {3.6770575288582983`*^9, 
   3.677057529110258*^9}, {3.677058943783944*^9, 3.6770589496621723`*^9}, {
   3.677059197807639*^9, 3.677059203094098*^9}, {3.723553772819351*^9, 
   3.723553776554186*^9}, {3.723553819729669*^9, 3.7235538298555*^9}, {
   3.72355407508072*^9, 3.723554104377223*^9}, {3.7235541388443108`*^9, 
   3.72355425334708*^9}, {3.7236046259823647`*^9, 3.723604626118053*^9}, {
   3.7236048971070547`*^9, 3.72360489773272*^9}, {3.7236049440031977`*^9, 
   3.723604945017849*^9}, {3.723604977147255*^9, 3.723604977594461*^9}, {
   3.723606931681498*^9, 3.72360695607819*^9}, {3.72360708009243*^9, 
   3.723607081474543*^9}, {3.7236074808851*^9, 3.723607495599334*^9}, {
   3.723607640328671*^9, 3.7236076759613037`*^9}, {3.723607893039379*^9, 
   3.723607895324959*^9}, {3.7236225631552877`*^9, 3.723622635562666*^9}, {
   3.7236227979938507`*^9, 3.723622798248267*^9}, {3.723623200543653*^9, 
   3.72362323913275*^9}, {3.723623881181329*^9, 3.723623882779088*^9}, {
   3.723624178033909*^9, 3.723624178137005*^9}, {3.7236242657264338`*^9, 
   3.723624265868928*^9}, {3.723624737828672*^9, 3.7236247380584087`*^9}, {
   3.723624798134631*^9, 3.723624799725082*^9}, {3.885794604394909*^9, 
   3.8857946074095507`*^9}, {3.885794795967772*^9, 3.885794798258589*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"1da544ee-c66b-4a0a-b9ee-aec39f4e3840"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"plot", "[", 
    RowBox[{"ax_", ",", "by_", ",", "cz_"}], "]"}], ":=", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"ContourPlot3D", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         FractionBox["M1", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"x1", "-", "x"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"y1", "-", "y"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"z1", "-", "z"}], ")"}], "2"]}], ")"}], "0.5"]], "+", 
         FractionBox["M2", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"x2", "-", "x"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"y2", "-", "y"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"z2", "-", "z"}], ")"}], "2"]}], ")"}], "0.5"]], "+", 
         RowBox[{
          FractionBox[
           RowBox[{"M1", "+", "M2"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"x2", "-", "x1"}], ")"}], "3"]], "*", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"xc", "-", "x"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"yc", "-", "y"}], ")"}], "2"]}]]}]}], "\[Equal]", 
        "0.6"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"x", ",", " ", 
        RowBox[{"-", "size"}], ",", " ", "size"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"y", ",", " ", 
        RowBox[{"-", "size"}], ",", " ", "size"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", " ", 
        RowBox[{"-", "size"}], ",", "size"}], "}"}], ",", 
      RowBox[{"Lighting", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}], ",", 
      " ", 
      RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
      RowBox[{"PlotPoints", "\[Rule]", "20"}], ",", " ", 
      RowBox[{"Mesh", "->", "None"}], ",", " ", 
      RowBox[{"ViewPoint", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"ax", ",", "by", ",", "cz"}], "}"}]}], ",", " ", 
      RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
      RowBox[{"ContourStyle", "\[Rule]", 
       RowBox[{"Directive", "[", "Blue", "]"}]}], ",", 
      RowBox[{"Axes", "\[Rule]", "False"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "size"}], ",", " ", "size"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "size"}], ",", "size"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "size"}], ",", "size"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"SphericalRegion", "\[Rule]", "True"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"plot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"1000", "*", 
     RowBox[{"Sin", "[", "Pi", "]"}]}], "+", "xc"}], ",", 
   RowBox[{"1000", "*", 
    RowBox[{"Cos", "[", "Pi", "]"}]}], ",", "500"}], "]"}]}], "Input",
 CellChangeTimes->{{3.676530614779953*^9, 3.676530662507159*^9}, {
   3.6765307093307447`*^9, 3.6765307145505333`*^9}, 3.676530773518632*^9, {
   3.6765311139290953`*^9, 3.6765311171575127`*^9}, {3.676531432488987*^9, 
   3.676531439614099*^9}, {3.676531703153734*^9, 3.6765317054840193`*^9}, {
   3.6765320289084177`*^9, 3.6765320295363913`*^9}, {3.676532075494769*^9, 
   3.676532076649201*^9}, {3.676532377546667*^9, 3.676532377994042*^9}, {
   3.676532414006008*^9, 3.676532421494034*^9}, {3.676541270245845*^9, 
   3.676541293996208*^9}, {3.676603202987627*^9, 3.676603216386747*^9}, {
   3.6766332297779617`*^9, 3.67663328025975*^9}, {3.6766333530610123`*^9, 
   3.676633437203933*^9}, {3.676633493815515*^9, 3.676633506102274*^9}, 
   3.676633738518744*^9, {3.67663378670197*^9, 3.676633863122629*^9}, {
   3.6766339328927917`*^9, 3.676633936931183*^9}, {3.676633985853489*^9, 
   3.6766340597535458`*^9}, {3.676634104298224*^9, 3.676634116199812*^9}, {
   3.67663419089542*^9, 3.676634192290188*^9}, {3.676634226826672*^9, 
   3.676634241153303*^9}, {3.676634375541059*^9, 3.676634409667488*^9}, {
   3.676634443998691*^9, 3.6766345087637777`*^9}, {3.6766383118168383`*^9, 
   3.676638317309946*^9}, {3.676638418140329*^9, 3.676638513148246*^9}, {
   3.6766533022581882`*^9, 3.67665330381476*^9}, {3.676653352528829*^9, 
   3.676653366005681*^9}, {3.676653397761241*^9, 3.676653415054471*^9}, {
   3.676653447635826*^9, 3.6766535321648407`*^9}, {3.676653568865663*^9, 
   3.676653708187292*^9}, {3.6766537419321127`*^9, 3.676653742538867*^9}, {
   3.676653773813856*^9, 3.6766537765237007`*^9}, {3.67665445465298*^9, 
   3.6766544743679533`*^9}, {3.6766545396932993`*^9, 
   3.6766545449217577`*^9}, {3.676654619665049*^9, 3.676654703973333*^9}, {
   3.676654947928659*^9, 3.6766549618774147`*^9}, {3.676655128944179*^9, 
   3.676655156825534*^9}, {3.676655222825721*^9, 3.676655226293988*^9}, {
   3.676655298785088*^9, 3.676655302456925*^9}, {3.676689512577087*^9, 
   3.6766895176705313`*^9}, {3.676692369543829*^9, 3.676692369894966*^9}, {
   3.6766929414008636`*^9, 3.6766929422604322`*^9}, {3.67669311164069*^9, 
   3.676693112158697*^9}, {3.677044848888023*^9, 3.677044908528758*^9}, {
   3.677044941013568*^9, 3.677045059893766*^9}, {3.6770451983240957`*^9, 
   3.677045231683443*^9}, {3.677046094673287*^9, 3.677046134568912*^9}, 
   3.7235542759134073`*^9, {3.7236046698856993`*^9, 3.723604670221204*^9}, {
   3.723605102247829*^9, 3.7236051028853197`*^9}, {3.723605218846936*^9, 
   3.723605219062298*^9}, {3.885792553319714*^9, 3.8857925921525583`*^9}, {
   3.885792677691687*^9, 3.885792677804492*^9}, {3.885792888627062*^9, 
   3.8857928910681143`*^9}, {3.885794230110791*^9, 3.885794296941575*^9}, {
   3.885794345589712*^9, 3.885794374879525*^9}, {3.8857946251910133`*^9, 
   3.885794635117959*^9}, {3.885794800321596*^9, 3.885794804010449*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"701724bf-94f6-47e5-9956-9e1d3b67b511"],

Cell[BoxData[
 RowBox[{
  RowBox[{"R", "=", "1000"}], ";", 
  RowBox[{"curv", " ", "=", 
   RowBox[{"Parallelize", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"t", ",", 
        RowBox[{"Length", "@", 
         RowBox[{"PixelValuePositions", "[", 
          RowBox[{
           RowBox[{"plot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"1000", "*", 
               RowBox[{"Sin", "[", 
                RowBox[{"2", "Pi", " ", "t"}], "]"}]}], "+", "xc"}], ",", 
             RowBox[{"1000", "*", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", "Pi", " ", "t"}], "]"}]}], ",", "0"}], "]"}], ",",
            " ", "Blue", ",", "0.5"}], "]"}]}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"t", ",", " ", "0", ",", " ", "1", ",", " ", "0.005"}], 
       "}"}]}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.885794395783163*^9, 3.885794513983539*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"c939518e-c149-4e4d-803d-de3e5567f76c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"max", "=", 
   RowBox[{"N", "[", 
    RowBox[{"Max", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"curv", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "@", "curv"}]}], "}"}]}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"curvl", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"SetPrecision", "[", 
        RowBox[{
         RowBox[{"curv", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "3"}], "]"}], ",", 
       RowBox[{"SetPrecision", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2.5"}], 
          RowBox[{"Log10", "[", 
           RowBox[{
            RowBox[{"curv", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}], "/", "max"}], "]"}]}], 
         ",", "3"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "200", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"TableForm", "[", 
    RowBox[{"N", "[", "curvl", "]"}], "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.885794553324018*^9, 3.885794577768073*^9}, {
  3.885794746662553*^9, 3.885794754468624*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"678ce7a3-d781-49a9-ae68-eef56f67f8b6"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"-", "curvl"}], ",", 
   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
   RowBox[{"InterpolationOrder", "\[Rule]", "2"}], ",", 
   RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", " ", 
   RowBox[{"AspectRatio", "\[Rule]", 
    RowBox[{"1", "/", "2"}]}], ",", 
   RowBox[{"FrameStyle", "\[Rule]", 
    RowBox[{"Thickness", "[", "Medium", "]"}]}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", "Black"}], ",", " ", 
   RowBox[{"ImageSize", "\[Rule]", "600"}], ",", " ", 
   RowBox[{"PlotRange", "\[Rule]", "Full"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.885794682170516*^9, 3.885794682852666*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"cc5e9166-bcca-46b4-8b79-1ab318d350be"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExportToCSV", "[", 
   RowBox[{
    RowBox[{"TableWithTitle", "[", 
     RowBox[{"curvl", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<t\>\"", ",", " ", "\"\<m\>\""}], "}"}]}], "]"}], ",", 
    RowBox[{"DataFileName", "[", "\"\<light-curve-W-UMa.csv\>\"", "]"}]}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{
  3.885794715115982*^9, {3.927445720879201*^9, 3.927445732574607*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"4f1d7a3b-93a1-4745-9756-513a29555e81"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"w", " ", "=", 
    RowBox[{"ContourPlot3D", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         FractionBox["M1", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"x1", "-", "x"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"y1", "-", "y"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"z1", "-", "z"}], ")"}], "2"]}], ")"}], "0.5"]], "+", 
         FractionBox["M2", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"x2", "-", "x"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"y2", "-", "y"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"z2", "-", "z"}], ")"}], "2"]}], ")"}], "0.5"]], "+", 
         RowBox[{
          FractionBox[
           RowBox[{"M1", "+", "M2"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"x2", "-", "x1"}], ")"}], "3"]], "*", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"xc", "-", "x"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"yc", "-", "y"}], ")"}], "2"]}]]}]}], "\[Equal]", 
        "0.6"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"x", ",", " ", 
        RowBox[{"-", "size"}], ",", " ", "size"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"y", ",", " ", 
        RowBox[{"-", "size"}], ",", " ", "size"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", " ", 
        RowBox[{"-", "size"}], ",", "size"}], "}"}], ",", " ", 
      RowBox[{"ImageSize", "\[Rule]", "1200"}], ",", 
      RowBox[{"PlotPoints", "\[Rule]", "20"}], ",", 
      RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", " ", 
      RowBox[{"Mesh", "->", "None"}], ",", " ", 
      RowBox[{"ViewPoint", "\[Rule]", "Front"}], ",", " ", 
      RowBox[{"Boxed", "\[Rule]", "False"}], ",", " ", 
      RowBox[{"Axes", "\[Rule]", "False"}], ",", " ", 
      RowBox[{"ContourStyle", "\[Rule]", "Black"}], ",", 
      RowBox[{"SphericalRegion", "\[Rule]", "True"}], ",", " ", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "size"}], ",", " ", "size"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "size"}], ",", "size"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "size"}], ",", "size"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"ViewCenter", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.5", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"xc", "/", "size"}]}], ")"}]}], ",", "0.5", ",", "0.5"}], 
        "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.8857948182447968`*^9, 3.885794988619486*^9}, {
  3.8857951796459513`*^9, 3.8857952373042727`*^9}, {3.885795315392261*^9, 
  3.88579545469827*^9}, {3.88579553238659*^9, 3.885795532834433*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"ddc7d75c-8fee-44cb-9126-97684952782b"],

Cell[BoxData[{
 RowBox[{"exportImage", "=", 
  RowBox[{"Lighter", "[", 
   RowBox[{
    RowBox[{"ImageAdjust", "[", 
     RowBox[{
      RowBox[{"RemoveBackground", "[", 
       RowBox[{"ImageCrop", "[", 
        RowBox[{
         RowBox[{"Rasterize", "[", "w", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"750", ",", "350"}], "}"}]}], "]"}], "]"}], ",", 
      RowBox[{"-", "0.4"}]}], "]"}], ",", "0.25"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<..\>\"", ",", 
       "\"\<img\>\"", ",", "\"\<w-uma.png\>\""}], "}"}], "]"}], ",", 
    "exportImage"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8857950304212313`*^9, 3.885795042859869*^9}, {
   3.885795274054821*^9, 3.885795292735351*^9}, {3.885795522205958*^9, 
   3.885795616139472*^9}, {3.885795674663157*^9, 3.885795675797269*^9}, 
   3.885795709926387*^9, {3.885795760590617*^9, 3.885795774696485*^9}, {
   3.885795813695562*^9, 3.88579588117419*^9}, {3.8857959122390347`*^9, 
   3.885795951030073*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"956a5df5-cf1f-4091-a62f-70d449ed7f31"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"a", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"i", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M1", " ", "=", " ", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M2", " ", "=", " ", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R1", " ", "=", " ", "19"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R2", " ", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T1", " ", "=", " ", "8000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T2", "=", " ", "13000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ec", " ", "=", " ", "0.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x1", " ", "=", " ", 
   RowBox[{"-", "50"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x2", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y1", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y2", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"z1", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"z2", " ", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"size", "=", "70"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xc", " ", "=", " ", 
   RowBox[{"x1", " ", "+", 
    RowBox[{
     RowBox[{"(", " ", 
      RowBox[{"x2", "-", "x1"}], ")"}], "*", 
     FractionBox["M2", 
      RowBox[{"M1", "+", "M2"}]]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yc", " ", "=", 
   RowBox[{"y1", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"y2", "-", "y1"}], ")"}], "*", 
     FractionBox["M2", 
      RowBox[{"M1", "+", "M2"}]]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zc", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"w", " ", "=", 
    RowBox[{"ContourPlot3D", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         FractionBox["M1", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"x1", "-", "x"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"y1", "-", "y"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"z1", "-", "z"}], ")"}], "2"]}], ")"}], "0.5"]], "+", 
         FractionBox["M2", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"x2", "-", "x"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"y2", "-", "y"}], ")"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"z2", "-", "z"}], ")"}], "2"]}], ")"}], "0.5"]], "+", 
         RowBox[{
          FractionBox[
           RowBox[{"M1", "+", "M2"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"x2", "-", "x1"}], ")"}], "3"]], "*", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"xc", "-", "x"}], ")"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"yc", "-", "y"}], ")"}], "2"]}]]}]}], "\[Equal]", 
        "3.638"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"x", ",", " ", 
        RowBox[{"-", "size"}], ",", " ", "size"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"y", ",", " ", 
        RowBox[{"-", "size"}], ",", " ", "size"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", " ", 
        RowBox[{"-", "size"}], ",", "size"}], "}"}], ",", 
      RowBox[{"ColorFunction", "\[Rule]", "Blue"}], ",", " ", 
      RowBox[{"ImageSize", "\[Rule]", "2000"}], ",", 
      RowBox[{"PlotPoints", "\[Rule]", "20"}], ",", " ", 
      RowBox[{"Mesh", "->", "None"}], ",", " ", 
      RowBox[{"ViewPoint", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"1000", ",", "0", ",", "0"}], "}"}]}], ",", " ", 
      RowBox[{"Boxed", "\[Rule]", "False"}], ",", " ", 
      RowBox[{"Axes", "\[Rule]", "False"}], ",", " ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Lighting", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"\"\<Ambient\>\"", ",", "White"}], "}"}], "}"}]}], ","}], 
       "*)"}], " ", 
      RowBox[{"ContourStyle", "\[Rule]", "Blue"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "size"}], ",", " ", "size"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "size"}], ",", "size"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "size"}], ",", "size"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"SphericalRegion", "\[Rule]", "True"}], ",", 
      RowBox[{"ViewCenter", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.5", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"xc", "/", "size"}]}], ")"}]}], ",", "0.5", ",", "0.5"}], 
        "}"}]}]}], "]"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.676457173956596*^9, 3.676457491243602*^9}, {
   3.676457552092285*^9, 3.676457570794736*^9}, {3.6764576173671827`*^9, 
   3.676457658691574*^9}, {3.676457865767721*^9, 3.67645792238699*^9}, {
   3.676457960177593*^9, 3.676458030130595*^9}, {3.676458063055647*^9, 
   3.676458063276194*^9}, {3.676458172823188*^9, 3.6764581974638453`*^9}, {
   3.676458232487108*^9, 3.676458453939522*^9}, {3.6764584847424994`*^9, 
   3.676458484967392*^9}, {3.6764585366563807`*^9, 3.676458555693852*^9}, {
   3.676458600832323*^9, 3.676458695528305*^9}, {3.6764587324375257`*^9, 
   3.676458964905037*^9}, {3.676459943140485*^9, 3.676459977130295*^9}, {
   3.676460563767744*^9, 3.676460566283453*^9}, {3.6764612461265707`*^9, 
   3.676461323528019*^9}, {3.676461358308157*^9, 3.676461500742168*^9}, {
   3.676461671421631*^9, 3.67646167683575*^9}, {3.6764618652452583`*^9, 
   3.67646196981113*^9}, {3.676462012054061*^9, 3.676462136405546*^9}, {
   3.676462175109786*^9, 3.676462194855711*^9}, {3.676462580511024*^9, 
   3.676462580841631*^9}, {3.676462699144706*^9, 3.6764627394170647`*^9}, {
   3.676462824032468*^9, 3.676462824737071*^9}, {3.676462873638769*^9, 
   3.67646293083327*^9}, {3.676483479589981*^9, 3.676483496606052*^9}, {
   3.676483536810607*^9, 3.6764835740862226`*^9}, {3.676485391291258*^9, 
   3.6764854629342327`*^9}, {3.6764854947857847`*^9, 3.676485496872099*^9}, {
   3.676485702374797*^9, 3.676485704999723*^9}, 3.676485794213129*^9, {
   3.676485846411422*^9, 3.676485853402976*^9}, {3.676485914706501*^9, 
   3.6764859440495977`*^9}, {3.676485997465846*^9, 3.676486018570496*^9}, {
   3.6764860745879097`*^9, 3.676486075444957*^9}, {3.6764861458826103`*^9, 
   3.6764861596977386`*^9}, {3.676511494823476*^9, 3.676511496971218*^9}, {
   3.6765115933819733`*^9, 3.6765116197375917`*^9}, {3.67651166257942*^9, 
   3.676511666266509*^9}, {3.6765117561623898`*^9, 3.6765117628563213`*^9}, {
   3.676511854336492*^9, 3.6765118553106956`*^9}, {3.6765119003692503`*^9, 
   3.67651198804921*^9}, {3.676512032396192*^9, 3.676512150296041*^9}, {
   3.676512206687216*^9, 3.676512220108457*^9}, {3.676512259241715*^9, 
   3.676512280642744*^9}, {3.676512337505814*^9, 3.6765123410800962`*^9}, {
   3.676512390338334*^9, 3.676512407310687*^9}, {3.676512471652937*^9, 
   3.6765125068496323`*^9}, {3.676512553525599*^9, 3.676512557060087*^9}, {
   3.676512601531638*^9, 3.676512630895247*^9}, {3.676529532119575*^9, 
   3.676529551308208*^9}, {3.676529587146002*^9, 3.676529587272131*^9}, {
   3.676529724126478*^9, 3.676529825877755*^9}, {3.676531225299466*^9, 
   3.6765313215512657`*^9}, {3.676531398636216*^9, 3.676531405206069*^9}, {
   3.6766333134972687`*^9, 3.676633346984105*^9}, {3.6766336335051622`*^9, 
   3.676633634367852*^9}, {3.676633815198419*^9, 3.676633819483934*^9}, {
   3.676653312243287*^9, 3.6766533172913523`*^9}, {3.676692712120428*^9, 
   3.676692713110422*^9}, {3.676692767344241*^9, 3.676692767495816*^9}, {
   3.676795068117978*^9, 3.6767950880196133`*^9}, {3.6767955194759283`*^9, 
   3.67679552168004*^9}, {3.6767955621344137`*^9, 3.6767955684598217`*^9}, {
   3.676796921439253*^9, 3.676796921581472*^9}, {3.676796963557104*^9, 
   3.676796966555122*^9}, {3.6767979630246983`*^9, 3.676797965911077*^9}, {
   3.677045166726016*^9, 3.677045168917433*^9}, {3.6770556924288683`*^9, 
   3.677055703291057*^9}, {3.677056133015834*^9, 3.67705613391922*^9}, {
   3.677056828382597*^9, 3.677056831149032*^9}, {3.6770575288582983`*^9, 
   3.677057529110258*^9}, {3.677058943783944*^9, 3.6770589496621723`*^9}, {
   3.677059197807639*^9, 3.677059203094098*^9}, {3.723553772819351*^9, 
   3.723553776554186*^9}, {3.723553819729669*^9, 3.7235538298555*^9}, {
   3.72355407508072*^9, 3.723554104377223*^9}, {3.7235541388443108`*^9, 
   3.72355425334708*^9}, {3.7236046259823647`*^9, 3.723604626118053*^9}, {
   3.7236048971070547`*^9, 3.72360489773272*^9}, {3.7236049440031977`*^9, 
   3.723604945017849*^9}, {3.723604977147255*^9, 3.723604977594461*^9}, {
   3.723606931681498*^9, 3.72360695607819*^9}, {3.72360708009243*^9, 
   3.723607081474543*^9}, {3.7236074808851*^9, 3.723607495599334*^9}, {
   3.723607640328671*^9, 3.7236076759613037`*^9}, {3.723607893039379*^9, 
   3.723607895324959*^9}, {3.7236225631552877`*^9, 3.723622635562666*^9}, {
   3.7236227979938507`*^9, 3.723622798248267*^9}, {3.723623200543653*^9, 
   3.72362323913275*^9}, {3.723623881181329*^9, 3.723623882779088*^9}, {
   3.723624178033909*^9, 3.723624178137005*^9}, {3.7236242657264338`*^9, 
   3.723624265868928*^9}, {3.723624737828672*^9, 3.7236247380584087`*^9}, {
   3.723624798134631*^9, 3.723624799725082*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"6ba893c5-b530-4946-8eaa-50d86f440014"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"r", " ", "=", " ", "30"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"d", " ", "=", "0.5"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotblyr", "[", 
    RowBox[{"ax_", ",", "by_", ",", "cz_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Evaluate", "[", 
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"ContourPlot3D", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            FractionBox["M1", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"x1", "-", "x"}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"y1", "-", "y"}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"z1", "-", "z"}], ")"}], "2"]}], ")"}], "0.5"]], 
            "+", 
            FractionBox["M2", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"x2", "-", "x"}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"y2", "-", "y"}], ")"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"z2", "-", "z"}], ")"}], "2"]}], ")"}], "0.5"]], 
            "+", 
            RowBox[{
             FractionBox[
              RowBox[{"M1", "+", "M2"}], 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"x2", "-", "x1"}], ")"}], "3"]], "*", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"xc", "-", "x"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"yc", "-", "y"}], ")"}], "2"]}]]}]}], "\[Equal]", 
           "0.585"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"x", ",", " ", 
           RowBox[{"-", "size"}], ",", " ", 
           RowBox[{"-", "30"}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"y", ",", " ", 
           RowBox[{"-", "size"}], ",", " ", "size"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"z", ",", " ", 
           RowBox[{"-", "size"}], ",", "size"}], "}"}], ",", " ", 
         RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
         RowBox[{"PlotPoints", "\[Rule]", "20"}], ",", " ", 
         RowBox[{"Mesh", "->", "None"}], ",", " ", 
         RowBox[{"ViewPoint", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"1000", ",", "0", ",", "0"}], "}"}]}], ",", " ", 
         RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
         RowBox[{"ContourStyle", "\[Rule]", 
          RowBox[{"Directive", "[", "Red", "]"}]}], ",", 
         RowBox[{"Axes", "\[Rule]", "False"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "size"}], ",", " ", "size"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "size"}], ",", "size"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "size"}], ",", "size"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"SphericalRegion", "\[Rule]", "True"}], ",", 
         RowBox[{"Lighting", "->", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}]}], 
        "]"}], ",", 
       RowBox[{"Graphics3D", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Blue", ",", 
           RowBox[{"Sphere", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x2", ",", "y2", ",", "z2"}], "}"}], ",", "R2"}], 
            "]"}]}], "}"}], ",", 
         RowBox[{"Axes", "\[Rule]", "True"}]}], " ", "]"}], ",", " ", 
       RowBox[{"Graphics3D", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Yellow", ",", 
           RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
           RowBox[{"Cylinder", "[", " ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x2", ",", "y2", ",", 
                 RowBox[{"-", "d"}]}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"x2", ",", " ", "y2", ",", " ", "d"}], "}"}]}], "}"}],
              ",", "r"}], "]"}]}], "}"}], ",", 
         RowBox[{"Axes", "\[Rule]", "True"}], ",", " ", 
         RowBox[{"Lighting", "->", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}]}], 
        "]"}], ",", 
       RowBox[{"Lighting", "->", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"\"\<Ambient\>\"", ",", " ", "White"}], "}"}], "}"}]}]}], 
      "]"}], "]"}], "/.", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1000", ",", "0", ",", "0"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"ax", ",", "by", ",", "cz"}], "}"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.676790883754743*^9, 3.676790924430451*^9}, {
   3.676791102750074*^9, 3.67679111130469*^9}, {3.676791300935439*^9, 
   3.676791350843073*^9}, 3.676791438395401*^9, {3.676791522809952*^9, 
   3.676791548580839*^9}, {3.676793851498353*^9, 3.676793867181876*^9}, {
   3.6767940465061417`*^9, 3.676794214819235*^9}, {3.676794619429771*^9, 
   3.676794626977973*^9}, {3.676794820698435*^9, 3.676794822496215*^9}, {
   3.676794920584045*^9, 3.676794939924925*^9}, {3.676794991447702*^9, 
   3.676795063822659*^9}, {3.676795362744515*^9, 3.676795448387423*^9}, {
   3.67679547950051*^9, 3.676795479873579*^9}, {3.676795577159589*^9, 
   3.676795578821048*^9}, {3.6767956147893763`*^9, 3.6767956388861637`*^9}, {
   3.676795673135972*^9, 3.67679567327079*^9}, {3.676795732939972*^9, 
   3.676796001838541*^9}, {3.676796036861205*^9, 3.676796139490013*^9}, {
   3.676796182428247*^9, 3.676796250822219*^9}, {3.676796307084749*^9, 
   3.6767963635207653`*^9}, {3.676796396018759*^9, 3.676796400842599*^9}, {
   3.676796478804483*^9, 3.6767964990639753`*^9}, {3.676796542289818*^9, 
   3.6767965830147047`*^9}, {3.676796614657805*^9, 3.676796619079711*^9}, {
   3.6767966743463907`*^9, 3.676796741988954*^9}, {3.6767967985821333`*^9, 
   3.6767968029726343`*^9}, {3.67679683795127*^9, 3.6767969130405416`*^9}, {
   3.67679695651292*^9, 3.676796958701934*^9}, {3.6767969946648073`*^9, 
   3.6767969961910686`*^9}, {3.676797053094574*^9, 3.6767971124366407`*^9}, {
   3.676797222953916*^9, 3.676797295854624*^9}, {3.6768009045465508`*^9, 
   3.676800914133544*^9}, {3.676808221050432*^9, 3.676808296536446*^9}, {
   3.6768171891754827`*^9, 3.676817189409355*^9}, {3.6768182292128143`*^9, 
   3.676818233718803*^9}, {3.676820640721908*^9, 3.6768206642551813`*^9}, {
   3.676821069590423*^9, 3.676821070085883*^9}, {3.6768229277339973`*^9, 
   3.6768229278292093`*^9}, {3.676886416589566*^9, 3.676886445794063*^9}, {
   3.676886570229615*^9, 3.676886590992115*^9}, {3.6768866642438183`*^9, 
   3.676886666026469*^9}, {3.676886725248723*^9, 3.6768867257202578`*^9}, {
   3.676886781823176*^9, 3.6768868014828053`*^9}, {3.676886840794297*^9, 
   3.676886850405717*^9}, {3.676969621200759*^9, 3.676969695711008*^9}, {
   3.6769697363061333`*^9, 3.6769697386329613`*^9}, {3.6769718535399733`*^9, 
   3.676971912729954*^9}, {3.676972002321142*^9, 3.676972004563909*^9}, {
   3.676972061685308*^9, 3.676972063245594*^9}, {3.677041811252426*^9, 
   3.677041832838448*^9}, {3.723607317668878*^9, 3.723607319240548*^9}, {
   3.723607354569805*^9, 3.723607418356114*^9}, {3.723607786142174*^9, 
   3.7236078691894283`*^9}, {3.7236081338878803`*^9, 
   3.7236082414954233`*^9}, {3.723608279762424*^9, 3.723608284770154*^9}, {
   3.723608346341051*^9, 3.723608365978896*^9}, {3.7236084535061417`*^9, 
   3.723608464736862*^9}, {3.723622713646497*^9, 3.723622771467152*^9}, {
   3.723622830157537*^9, 3.723622832587092*^9}, {3.7236232651470947`*^9, 
   3.723623348108411*^9}, {3.723623384538306*^9, 3.723623577638131*^9}, {
   3.723623659959951*^9, 3.723623691552061*^9}, {3.723624109439335*^9, 
   3.723624116797717*^9}, {3.7236242180296173`*^9, 3.7236242454951363`*^9}, {
   3.723624286266205*^9, 3.723624320238904*^9}, {3.723624376503022*^9, 
   3.723624524842618*^9}, {3.723624714060833*^9, 3.723624714356771*^9}, {
   3.723624789921625*^9, 3.723624853976446*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"a5d4583d-a907-484e-b830-69f1d0113d24"],

Cell[BoxData[
 RowBox[{"plotblyr", "[", 
  RowBox[{"1000", ",", "0", ",", "300"}], "]"}]], "Input",
 CellChangeTimes->{{3.676790912542993*^9, 3.676790939610498*^9}, {
   3.676795618632419*^9, 3.676795622230242*^9}, {3.676972066753456*^9, 
   3.676972107865212*^9}, {3.676972142936428*^9, 3.676972178945635*^9}, {
   3.676976173801484*^9, 3.676976179986905*^9}, {3.677041306014038*^9, 
   3.677041332986786*^9}, 3.6770418540820503`*^9, {3.723607337279583*^9, 
   3.723607339825921*^9}, {3.7236074076475477`*^9, 3.7236074115371847`*^9}, {
   3.723623227680934*^9, 3.7236232307824*^9}, {3.723623373616794*^9, 
   3.723623374723675*^9}, {3.7236241540858297`*^9, 3.7236241557960987`*^9}, {
   3.885797376012539*^9, 3.885797379449478*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"c616684f-208d-4359-a62b-07aa42886d04"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"T3", "=", "5000"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"R", "=", "1000"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"curv", "=", " ", 
     RowBox[{"Parallelize", "[", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          FractionBox["i", 
           RowBox[{"2", "Pi"}]], ",", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              FractionBox["T2", "T1"], ")"}], "4"], "*", 
            RowBox[{"Length", "@", 
             RowBox[{"PixelValuePositions", "[", 
              RowBox[{
               RowBox[{"plotblyr", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"R", "*", 
                   RowBox[{"Sin", "[", "i", "]"}]}], "+", "xc"}], ",", " ", 
                 RowBox[{"R", "*", 
                  RowBox[{"Cos", "[", "i", "]"}]}], ",", "200"}], "]"}], ",", 
               "Blue", ",", "0.1"}], "]"}]}]}], "+", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              FractionBox["T3", "T1"], ")"}], "4"], "*", 
            RowBox[{"Length", "@", 
             RowBox[{"PixelValuePositions", "[", 
              RowBox[{
               RowBox[{"plotblyr", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"R", "*", 
                   RowBox[{"Sin", "[", "i", "]"}]}], "+", "xc"}], ",", " ", 
                 RowBox[{"R", "*", 
                  RowBox[{"Cos", "[", "i", "]"}]}], ",", "200"}], "]"}], ",", 
               "Yellow", ",", "0.1"}], "]"}]}]}], "+", 
           RowBox[{"Length", "@", 
            RowBox[{"PixelValuePositions", "[", 
             RowBox[{
              RowBox[{"plotblyr", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"R", "*", 
                  RowBox[{"Sin", "[", "i", "]"}]}], "+", "xc"}], ",", " ", 
                RowBox[{"R", "*", 
                 RowBox[{"Cos", "[", "i", "]"}]}], ",", "200"}], "]"}], ",", 
              "Red", ",", "0.1"}], "]"}]}]}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "0", ",", " ", 
          RowBox[{"2", "Pi"}], ",", " ", 
          RowBox[{"Pi", "/", "29"}]}], "}"}]}], "]"}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.676797591976508*^9, 3.676797754400585*^9}, {
   3.6767978248404408`*^9, 3.6767978357583838`*^9}, {3.676797903465166*^9, 
   3.676797928301695*^9}, {3.6767982860644903`*^9, 3.676798286392021*^9}, {
   3.676798513726666*^9, 3.6767985263322487`*^9}, {3.676799375722734*^9, 
   3.676799429379272*^9}, {3.676799910146866*^9, 3.6767999160842953`*^9}, {
   3.6767999721221113`*^9, 3.676799983301651*^9}, {3.6768000165082903`*^9, 
   3.676800060161779*^9}, {3.6768010069342947`*^9, 3.676801007900358*^9}, {
   3.676807964760302*^9, 3.676807970469042*^9}, {3.6768081770156527`*^9, 
   3.6768081777430983`*^9}, {3.676808498033471*^9, 3.6768084994563637`*^9}, 
   3.6768086098832808`*^9, {3.6768086554761047`*^9, 3.676808656928244*^9}, {
   3.6768201255165873`*^9, 3.676820140594434*^9}, {3.676820537060315*^9, 
   3.676820537562385*^9}, {3.6768207733022842`*^9, 3.676820773875555*^9}, 
   3.676821115759465*^9, {3.676822053815776*^9, 3.676822054725852*^9}, 
   3.676823165405293*^9, {3.676883424592906*^9, 3.676883426143258*^9}, {
   3.6768834573927803`*^9, 3.6768834579509*^9}, {3.6769697636428757`*^9, 
   3.676969773980871*^9}, {3.676970547197946*^9, 3.676970576141651*^9}, {
   3.676971148535201*^9, 3.6769711522844467`*^9}, {3.6770417926222982`*^9, 
   3.677041793225237*^9}, {3.677042382522566*^9, 3.677042382613451*^9}, {
   3.677042515467374*^9, 3.677042521214855*^9}, {3.6770425957945957`*^9, 
   3.6770425959663143`*^9}, {3.67704306210128*^9, 3.67704306945186*^9}, {
   3.677043550422687*^9, 3.677043558306779*^9}, {3.723623724594795*^9, 
   3.7236237718721743`*^9}, {3.723623917123155*^9, 3.7236239740973577`*^9}, {
   3.723624938978375*^9, 3.723624944250202*^9}, {3.723625163213826*^9, 
   3.7236251874069853`*^9}, {3.723625229835435*^9, 3.723625233296309*^9}, {
   3.723625443753071*^9, 3.723625443947959*^9}, {3.723625495890422*^9, 
   3.7236254993022623`*^9}, {3.723625532915303*^9, 3.72362553517248*^9}, {
   3.7236256490186243`*^9, 3.723625652871954*^9}, {3.723626126709548*^9, 
   3.723626132827429*^9}, {3.885797483447957*^9, 3.885797487672969*^9}, {
   3.885797539429967*^9, 3.885797539544196*^9}, {3.885797789898408*^9, 
   3.8857977916617727`*^9}, {3.8857981082232018`*^9, 3.885798110001898*^9}, {
   3.88579861721414*^9, 3.885798617635931*^9}, {3.885798764865264*^9, 
   3.885798779178359*^9}, {3.885798937928952*^9, 3.885798937994247*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"ba4e7cce-8316-40ac-b7d6-5395319c1cb0"],

Cell[BoxData[{
 RowBox[{"max", "=", 
  RowBox[{"N", "[", 
   RowBox[{"Max", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"curv", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "@", "curv"}]}], "}"}]}], "]"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"curvl", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"SetPrecision", "[", 
        RowBox[{
         RowBox[{"curv", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "3"}], "]"}], ",", 
       RowBox[{"SetPrecision", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2.5"}], 
          RowBox[{"Log10", "[", 
           RowBox[{
            RowBox[{"curv", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}], "/", "max"}], "]"}]}], 
         ",", "3"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "@", "curv"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"TableForm", "[", "curvl", "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.885794553324018*^9, 3.885794577768073*^9}, {
   3.885794746662553*^9, 3.885794754468624*^9}, {3.885797767404922*^9, 
   3.885797776012391*^9}, {3.88579814295308*^9, 3.885798182204212*^9}, {
   3.885798659029633*^9, 3.885798736547263*^9}, 3.885798785294381*^9, {
   3.885798825379425*^9, 3.885798854490361*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"59c0cfab-c368-4d89-88d7-5c45335c8a85"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"-", "curvl"}], ",", 
   RowBox[{"Joined", "\[Rule]", "True"}], ",", 
   RowBox[{"InterpolationOrder", "\[Rule]", "2"}], ",", 
   RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", " ", 
   RowBox[{"AspectRatio", "\[Rule]", 
    RowBox[{"1", "/", "2"}]}], ",", 
   RowBox[{"FrameStyle", "\[Rule]", 
    RowBox[{"Thickness", "[", "Medium", "]"}]}], ",", 
   RowBox[{"PlotStyle", "\[Rule]", "Black"}], ",", " ", 
   RowBox[{"ImageSize", "\[Rule]", "600"}], ",", " ", 
   RowBox[{"PlotRange", "\[Rule]", "Full"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.885794682170516*^9, 3.885794682852666*^9}, {
  3.885797843990798*^9, 3.8857978459974194`*^9}, {3.8857988367811747`*^9, 
  3.8857988467791452`*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"0377db45-75c1-463a-b34c-9ac02d885a0d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExportToCSV", "[", 
   RowBox[{
    RowBox[{"TableWithTitle", "[", 
     RowBox[{"curvl", ",", 
      RowBox[{"{", 
       RowBox[{"\"\<t\>\"", ",", " ", "\"\<m\>\""}], "}"}]}], "]"}], ",", 
    RowBox[{"DataFileName", "[", "\"\<light-curve-B-Lyr.csv\>\"", "]"}]}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.885798891397023*^9, 3.8857989099020863`*^9}, {
  3.927445754474575*^9, 3.92744576549209*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"2d39124f-1fb4-4c4f-a3e6-5110d9875588"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"w", "=", 
   RowBox[{"Evaluate", "[", 
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"ContourPlot3D", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           FractionBox["M1", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x1", "-", "x"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"y1", "-", "y"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"z1", "-", "z"}], ")"}], "2"]}], ")"}], "0.5"]], "+", 
           FractionBox["M2", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"x2", "-", "x"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"y2", "-", "y"}], ")"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"z2", "-", "z"}], ")"}], "2"]}], ")"}], "0.5"]], "+", 
           RowBox[{
            FractionBox[
             RowBox[{"M1", "+", "M2"}], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"x2", "-", "x1"}], ")"}], "3"]], "*", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"xc", "-", "x"}], ")"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"yc", "-", "y"}], ")"}], "2"]}]]}]}], "\[Equal]", 
          "0.585"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"x", ",", " ", 
          RowBox[{"-", "size"}], ",", " ", 
          RowBox[{"-", "30"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"y", ",", " ", 
          RowBox[{"-", "size"}], ",", " ", "size"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"z", ",", " ", 
          RowBox[{"-", "size"}], ",", "size"}], "}"}], ",", " ", 
        RowBox[{"ImageSize", "\[Rule]", "800"}], ",", 
        RowBox[{"PlotPoints", "\[Rule]", "20"}], ",", " ", 
        RowBox[{"Mesh", "->", "None"}], ",", " ", 
        RowBox[{"ViewPoint", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1000", ",", "300"}], "}"}]}], ",", " ", 
        RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
        RowBox[{"ContourStyle", "\[Rule]", 
         RowBox[{"Directive", "[", "Red", "]"}]}], ",", 
        RowBox[{"Axes", "\[Rule]", "False"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "size"}], ",", " ", "size"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "size"}], ",", "size"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "size"}], ",", "size"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"SphericalRegion", "\[Rule]", "True"}], ",", 
        RowBox[{"Lighting", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"\"\<Directional\>\"", ",", "White", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "2", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "}"}], 
          "}"}]}]}], "]"}], ",", 
      RowBox[{"Graphics3D", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Blue", ",", 
          RowBox[{"Sphere", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x2", ",", "y2", ",", "z2"}], "}"}], ",", "R2"}], 
           "]"}]}], "}"}], ",", 
        RowBox[{"Axes", "\[Rule]", "True"}]}], " ", "]"}], ",", " ", 
      RowBox[{"Graphics3D", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Yellow", ",", 
          RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
          RowBox[{"Cylinder", "[", " ", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x2", ",", "y2", ",", 
                RowBox[{"-", "d"}]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"x2", ",", " ", "y2", ",", " ", "d"}], "}"}]}], "}"}], 
            ",", "r"}], "]"}]}], "}"}], ",", 
        RowBox[{"Axes", "\[Rule]", "True"}], ",", " ", 
        RowBox[{"Lighting", "->", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"\"\<Directional\>\"", ",", "White", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "2", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "}"}], 
          "}"}]}]}], "]"}], ",", 
      RowBox[{"Lighting", "->", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"\"\<Directional\>\"", ",", "White", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "2", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], "}"}], 
        "}"}]}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"exportImage", "=", 
  RowBox[{"Lighter", "[", 
   RowBox[{
    RowBox[{"ImageAdjust", "[", 
     RowBox[{
      RowBox[{"ColorConvert", "[", 
       RowBox[{
        RowBox[{"RemoveBackground", "[", 
         RowBox[{"ImageTrim", "[", 
          RowBox[{
           RowBox[{"Rasterize", "[", "w", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"590", ",", "700"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1220", ",", "900"}], "}"}]}], "}"}]}], "]"}], "]"}], 
        ",", "\"\<Grayscale\>\""}], "]"}], ",", 
      RowBox[{"-", "0.4"}]}], "]"}], ",", "0.4"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<..\>\"", ",", 
       "\"\<img\>\"", ",", "\"\<b-lyr.png\>\""}], "}"}], "]"}], ",", 
    "exportImage"}], "]"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8857990059761667`*^9, 3.885799127625971*^9}, {
  3.885799239035541*^9, 3.885799251778784*^9}, {3.8857992906661*^9, 
  3.885799306689733*^9}, {3.885799665943902*^9, 3.8857996686159687`*^9}, {
  3.885799708463242*^9, 3.885799709484796*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"18ee065a-2750-48f2-8b95-a5648fd67ed7"]
}, Open  ]]
},
WindowSize->{1052, 847},
WindowMargins->{{311, Automatic}, {Automatic, 60}},
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (March 13, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"3e719116-3e46-4039-9045-7f11d14371e1"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[422, 15, 168, 3, 98, "Title",ExpressionUUID->"b7f4011e-e9d4-46b3-b2ab-03faecbdfd2a"],
Cell[593, 20, 315, 8, 30, "Input",ExpressionUUID->"db952e11-ccf7-46c2-b20e-50c6fa6c124a"],
Cell[911, 30, 16640, 290, 595, "Input",ExpressionUUID->"1bab7617-b89c-42e3-bb69-e39a3242625f"],
Cell[17554, 322, 2647, 52, 164, "Input",ExpressionUUID->"4f9758ef-d1f4-4698-992e-788854f478a1"],
Cell[20204, 376, 1918, 51, 94, "Input",ExpressionUUID->"0a37df63-3d2d-4a5a-b3eb-3e0affb67df8"],
Cell[22125, 429, 2196, 35, 52, "Input",ExpressionUUID->"92ead85a-9cd5-4c2e-8a1f-3e66f6c3180e"],
Cell[24324, 466, 1056, 19, 30, "Input",ExpressionUUID->"dffb5650-60d6-43d6-b5ac-8f31d853d145"],
Cell[25383, 487, 3348, 88, 157, "Input",ExpressionUUID->"337e3b12-fbef-43c2-a7d9-49a2e78aff25"],
Cell[28734, 577, 176, 3, 30, "Input",ExpressionUUID->"6bbaf767-54db-48b1-a34f-8707d819516c"],
Cell[28913, 582, 6632, 116, 444, "Input",ExpressionUUID->"1da544ee-c66b-4a0a-b9ee-aec39f4e3840"],
Cell[35548, 700, 6386, 136, 226, "Input",ExpressionUUID->"701724bf-94f6-47e5-9956-9e1d3b67b511"],
Cell[41937, 838, 1030, 26, 73, "Input",ExpressionUUID->"c939518e-c149-4e4d-803d-de3e5567f76c"],
Cell[42970, 866, 1482, 44, 73, "Input",ExpressionUUID->"678ce7a3-d781-49a9-ae68-eef56f67f8b6"],
Cell[44455, 912, 745, 15, 52, "Input",ExpressionUUID->"cc5e9166-bcca-46b4-8b79-1ab318d350be"],
Cell[45203, 929, 498, 12, 30, "Input",ExpressionUUID->"4f1d7a3b-93a1-4745-9756-513a29555e81"],
Cell[45704, 943, 3483, 91, 198, "Input",ExpressionUUID->"ddc7d75c-8fee-44cb-9126-97684952782b"],
Cell[49190, 1036, 1225, 29, 52, "Input",ExpressionUUID->"956a5df5-cf1f-4091-a62f-70d449ed7f31"],
Cell[50418, 1067, 9985, 211, 574, "Input",ExpressionUUID->"6ba893c5-b530-4946-8eaa-50d86f440014"],
Cell[60406, 1280, 8712, 188, 365, "Input",ExpressionUUID->"a5d4583d-a907-484e-b830-69f1d0113d24"],
Cell[69121, 1470, 812, 12, 30, "Input",ExpressionUUID->"c616684f-208d-4359-a62b-07aa42886d04"],
Cell[69936, 1484, 4835, 95, 231, "Input",ExpressionUUID->"ba4e7cce-8316-40ac-b7d6-5395319c1cb0"],
Cell[74774, 1581, 1677, 46, 73, "Input",ExpressionUUID->"59c0cfab-c368-4d89-88d7-5c45335c8a85"],
Cell[76454, 1629, 853, 18, 52, "Input",ExpressionUUID->"0377db45-75c1-463a-b34c-9ac02d885a0d"],
Cell[77310, 1649, 527, 13, 30, "Input",ExpressionUUID->"2d39124f-1fb4-4c4f-a3e6-5110d9875588"],
Cell[77840, 1664, 6849, 181, 429, "Input",ExpressionUUID->"18ee065a-2750-48f2-8b95-a5648fd67ed7"]
}, Open  ]]
}
]
*)

